(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5240],{85240:function(t,n,e){"use strict";e.d(n,{uR:function(){return b},D_:function(){return v.D_},ZP:function(){return _}});var i=e(22122),r=e(63349),o=e(6610),c=e(5991),a=e(10379),s=e(46070),u=e(77608),l=e(21914),f=e(28454),h=e(99010),d=e(96156),v=e(64107),p=e(46619);function g(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,u.Z)(t);if(n){var r=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)}}var y=function(t){(0,a.Z)(e,t);var n=g(e);function e(t){var i;return(0,o.Z)(this,e),(i=n.call(this,t)).interval=null,i.onInterval=i.onInterval.bind((0,r.Z)(i)),i}return(0,c.Z)(e,[{key:"componentDidMount",value:function(){this.interval=setInterval(this.onInterval,100),this.intervalList=this.props.intervalList}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"onInterval",value:function(){var t=document.querySelector(".vf-comments[data-engage]");if(t){var n=parseInt(t.getAttribute("data-engage"));n<=0||(this.intervalList=this.intervalList.filter((function(t,e){return!(t<=n)||((0,v.oz)(),!1)})),this.intervalList.isEmpty()&&clearInterval(this.interval))}}},{key:"render",value:function(){return null}}]),e}(l.PureComponent);(0,d.Z)(y,"defaultProps",{intervalList:(0,p.List)([3e3])});var Z=e(92972),m=e.n(Z);function D(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,u.Z)(t);if(n){var r=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,s.Z)(this,e)}}var k=function(t){window&&(window.MPULSE_ABTEST=t)},b=function(t){(0,a.Z)(e,t);var n=D(e);function e(t){var i;return(0,o.Z)(this,e),(i=n.call(this,t)).state={decision:null,agent:t.agent,getDecision:function(){},error:""},i.abort=!1,i}return(0,c.Z)(e,[{key:"getDecision",value:function(t){if(t){var n=this;(0,h.ZP)(t).then((function(e){n.abort||(n.setState({decision:e}),k("".concat(t,"-").concat(e)))})).catch((function(t){n.abort||(f.Z.send(t),n.setState({error:t}))}))}}},{key:"componentDidMount",value:function(){this.setState({getDecision:this.getDecision.bind(this)}),this.getDecision(this.state.agent)}},{key:"componentWillUnmount",value:function(){this.abort=!0,k("")}},{key:"render",value:function(){var t=this.props,n=t.decisionMap;if(this.state.agent&&this.state.decision){var e=n.get(this.state.decision);if(e)return l.createElement("span",{className:"sclt-abtest-".concat(this.state.agent)},e)}if(this.state.error){var i=n.get(t.fallback);if(i)return i}return null}}],[{key:"getDerivedStateFromProps",value:function(t,n){return t.agent!==n.agent?(n.getDecision(t.agent),{agent:t.agent,error:"",decision:null}):null}}]),e}(l.Component);b.propTypes={agent:m().string,decisionMap:m().instanceOf(p.Map),fallback:m().string},b.defaultProps={agent:"",decisionMap:new p.Map,fallback:""};var R=function(t){var n=t.abtest,e=t.children;return n>0?e[n-1]:e[0]||null},_=(0,l.memo)((function(t){return l.createElement((n=R,e=t.agent,s=t.check,function(t){(0,a.Z)(d,t);var u=D(d);function d(t){var n;return(0,o.Z)(this,d),(n=u.call(this,t)).abort=!1,n.state={decision:0},n.decision=null,n.onDecisionError=n.onDecisionError.bind((0,r.Z)(n)),n.onDecision=n.onDecision.bind((0,r.Z)(n)),n}return(0,c.Z)(d,[{key:"onDecision",value:function(t){if(!this.abort&&"string"===typeof t){var n=Math.max(0,t.charCodeAt(0)-65)+1||0;this.setState({decision:n}),k(t?"".concat(e,"-").concat(t):""),this.decision=null}}},{key:"onDecisionError",value:function(t){this.abort||(f.Z.send(t),this.decision=null)}},{key:"componentDidMount",value:function(){this.createDecision()}},{key:"componentDidUpdate",value:function(t,n){this.createDecision()}},{key:"createDecision",value:function(){0===this.state.decision&&(k(""),s&&!s(this.props)||this.decision||(this.decision=(0,h.ZP)(e).then(this.onDecision).catch(this.onDecisionError)))}},{key:"componentWillUnmount",value:function(){this.abort=!0,k("")}},{key:"render",value:function(){return l.createElement(n,(0,i.Z)({},this.props,{abtest:this.state.decision}))}}],[{key:"getDerivedStateFromProps",value:function(t,n){return n.decision>0&&s&&!s(t)?{decision:0}:null}}]),d}(l.PureComponent)),t);var n,e,s}),(function(t,n){return t.agent===n.agent&&(t.check===n.check||!(!t.agent||!n.check)&&t.agent.toString()!==n.agent.toString())}));_.propTypes={agent:m().string.isRequired,check:m().func,children:m().node.isRequired}},64107:function(t,n,e){"use strict";e.d(n,{Tn:function(){return p},oz:function(){return g},FQ:function(){return y},D_:function(){return Z}});var i=e(6610),r=e(10379),o=e(46070),c=e(77608),a=e(45366),s=e(28454);function u(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=(0,c.Z)(t);if(n){var r=(0,c.Z)(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return(0,o.Z)(this,e)}}var l=function(t){(0,r.Z)(e,t);var n=u(e);function e(){return(0,i.Z)(this,e),n.apply(this,arguments)}return e}((0,a.Z)(Error)),f=(new l("Failed to sendReadArticleGoal"),new l("Failed to send goal")),h=new l("Failed to send goal status not 200"),d=new l("Failed in selecting item goal"),v=function(t){200!==t.status&&s.Z.send(h)},p=function(t){try{window.CBC.APP.AB.Testing.sendGoal(t,1,v)||s.Z.send(f)}catch(n){s.Z.send(f)}},g=function(){return p("api-read-comment")},y=function(t,n){return function(e){try{e.target.closest(t)&&p(n)}catch(i){s.Z.send(new l("Failed in firing custom goal"))}}},Z=function(t){return function(n){try{n.target.closest(t)&&p("api-selected-item")}catch(e){s.Z.send(d)}}}}}]);