!function(e,o,c){function s(e){}function t(e,o,t){for(this.callback=t||s,this.errors=[],this.fields={},this.form=this._formByNameOrNode(e)||{},this.messages={},this.handlers={},e=0,t=o.length;e<t;e++){var n=o[e];if((n.name||n.names)&&n.rules)if(n.names)for(var i=0;i<n.names.length;i++)this._addField(n,n.names[i]);else this._addField(n,n.name)}var a,r=this.form.onsubmit;this.form.onsubmit=(a=this,function(e){try{return a._validateForm(e)&&(r===c||r())}catch(e){}})}function i(e,o){var t;if(!(0<e.length)||"radio"!==e[0].type&&"checkbox"!==e[0].type)return e[o];for(t=0;t<e.length;t++)if(e[t].checked)return e[t][o]}var p={required:"The %s field is required.",valid_phoneno:"The %s field is not valid.",matches:"The %s field does not match the %s field.",default:"The %s field is still set to default, please change.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",alpha_numeric_dash_combo:"The %s field must contain only combination of alpha-numeric characters and dashes.",alphanumeric_combo:"The %s field must contain only combination of alpha-numeric characters.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL.",valid_ca_zip:"The %s field must contain a valid Postal Code."},n=/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/,a=/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/,d=/^(.+?)\[(.+)\]$/,r=/^[0-9]+$/,l=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[-])[A-Za-z\d][A-Za-z\d-]+$/i,u=/^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$/,m=/^\-?[0-9]+$/,g=/^\-?[0-9]*\.?[0-9]+$/,f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=/^[a-z]+$/i,y=/^[a-z0-9]+$/i,v=/^[a-z0-9_\-]+$/i,C=/^[0-9]+$/i,w=/^[1-9][0-9]*$/i,T=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,S=/[^a-zA-Z0-9\/\+=]/i,k=/^[\d\-\s]+$/,L=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;t.prototype.setMessage=function(e,o){return this.messages[e]=o,this},t.prototype.registerCallback=function(e,o){return e&&"string"==typeof e&&o&&"function"==typeof o&&(this.handlers[e]=o),this},t.prototype._formByNameOrNode=function(e){return"object"==typeof e?e:o.forms[e]},t.prototype._addField=function(e,o){this.fields[o]={name:o,display:e.display||o,rules:e.rules,id:null,type:null,value:null,checked:null}},t.prototype._validateForm=function(e){for(var o in this.errors=[],this.fields){var t,n;this.fields.hasOwnProperty(o)&&(t=this.fields[o]||{},(n=this.form[t.name])&&n!==c&&(t.id=i(n,"id"),t.type=0<n.length?n[0].type:n.type,t.value=i(n,"value"),t.checked=i(n,"checked"),this._validateField(t)))}return"function"==typeof this.callback&&this.callback(this.errors,e),0<this.errors.length&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),!0},t.prototype._validateField=function(e){for(var o=e.rules.split("|"),t=e.rules.indexOf("required"),n=!e.value||""===e.value||e.value===c,i=0,a=o.length;i<a;i++){var r=o[i],s=null,l=!1,u=d.exec(r);if((-1!==t||-1!==r.indexOf("!callback_")||!n)&&(u&&(r=u[1],s=u[2]),"!"===r.charAt(0)&&(r=r.substring(1,r.length)),"function"==typeof this._hooks[r]?this._hooks[r].apply(this,[e,s])||(l=!0):"callback_"===r.substring(0,9)&&(r=r.substring(9,r.length),"function"==typeof this.handlers[r]&&!1===this.handlers[r].apply(this,[e.value,s])&&(l=!0)),l)){o=this.messages[r+"#"+e.name]||this.messages[r]||p[r],t="An error has occurred with the "+e.display+" field.",o&&(t=o.replace("%s",e.display),s&&((cu=0<=s.indexOf("###")&&s.split("###"))?cu[1]&&(t=cu[1]):t=t.replace("%s",this.fields[s]?this.fields[s].display:s))),this.errors.push({Id:e.id,Name:e.name,Message:t,Rule:r});break}}},t.prototype._hooks={required:function(e){var o=e.value.trim();return"checkbox"===e.type||"radio"===e.type?!0===e.checked:null!==o&&""!==o},default:function(e,o){return e.value!==o},matches:function(e,o){var t=this.form[o];return!!t&&e.value===t.value},valid_ca_zip:function(e){return n.test(e.value)},valid_email:function(e){return f.test(e.value)},valid_emails:function(e){e=e.value.split(",");for(var o=0;o<e.length;o++)if(!f.test(e[o]))return!1;return!0},min_length:function(e,o){return!!r.test(o)&&e.value.length>=parseInt(o,10)},max_length:function(e,o){return!!r.test(o)&&e.value.length<=parseInt(o,10)},exact_length:function(e,o){return!!r.test(o)&&e.value.length===parseInt(o,10)},greater_than:function(e,o){return!!g.test(e.value)&&parseFloat(e.value)>parseFloat(o)},less_than:function(e,o){return!!g.test(e.value)&&parseFloat(e.value)<parseFloat(o)},alpha:function(e){return h.test(e.value)},alpha_numeric:function(e){return y.test(e.value)},alpha_dash:function(e){return v.test(e.value)},alpha_numeric_dash_combo:function(e){return l.test(e.value)},alphanumeric_combo:function(e){return u.test(e.value)},numeric:function(e){return r.test(e.value)},integer:function(e){return m.test(e.value)},decimal:function(e){return g.test(e.value)},is_natural:function(e){return C.test(e.value)},is_natural_no_zero:function(e){return w.test(e.value)},valid_ip:function(e){return T.test(e.value)},valid_phoneno:function(e){return a.test(e.value)},valid_base64:function(e){return S.test(e.value)},valid_url:function(e){return L.test(e.value)},valid_credit_card:function(e){if(!k.test(e.value))return!1;for(var o=0,t=0,n=!1,i=(e=e.value.replace(/\D/g,"")).length-1;0<=i;i--)t=e.charAt(i),t=parseInt(t,10),n&&9<(t*=2)&&(t-=9),o+=t,n=!n;return 0==o%10},is_file_type:function(e,o){if("file"!==e.type)return!0;for(var t=e.value.substr(e.value.lastIndexOf(".")+1),n=o.split(","),i=!1,a=0,r=n.length;a<r;a++)t==n[a]&&(i=!0);return i}},e.FormValidator=t}(window,document);var LRNameSpace={};!function(i){i.Storage=function(n,t){return{isLocalStorageNameSupported:function(e){if(!window[e])return!1;var o=window[e];try{return o.setItem("test","1"),o.removeItem("test"),!0}catch(e){return!1}},setBrowserStorage:function(e,o){var t=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.setItem(e,o),t=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.setItem(e,o),t=!1),t&&n&&n.options&&i.cookies.setItem(e,o,"",n.options.appPath)},getBrowserStorage:function(e){if(t&&e===t.storedTokenName){var o=this.getBrowserStorage("lr-session-token");if(o)return o=o.replace(/"/g,""),this.setBrowserStorage(t.storedTokenName,o),o}return this.isLocalStorageNameSupported("localStorage")&&null!==localStorage.getItem(e)&&void 0!==localStorage.getItem(e)&&""!==localStorage.getItem(e)?localStorage.getItem(e):this.isLocalStorageNameSupported("sessionStorage")&&null!==sessionStorage.getItem(e)&&void 0!==sessionStorage.getItem(e)&&""!==sessionStorage.getItem(e)?sessionStorage.getItem(e):i.cookies.getItem(e)},removeBrowserStorage:function(e){var o=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.removeItem(e),o=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.removeItem(e),o=!1),o&&n&&n.options&&i.cookies.removeItem(e,n.options.appPath)}}}}(LRNameSpace),LRNameSpace.cookies={intToString:function(e){return e.toString()},stringToInt:function(e){return parseInt(e,10)||0},isSameSiteNoneCompatible:function(e){return!this.isSameSiteNoneIncompatible(e.toString())},isSameSiteNoneIncompatible:function(e){return this.hasWebKitSameSiteBug(e)||this.dropsUnrecognizedSameSiteCookies(e)},hasWebKitSameSiteBug:function(e){return this.isIosVersion(12,e)||this.isMacosxVersion(10,14,e)&&(this.isSafari(e)||this.isMacEmbeddedBrowser(e))},dropsUnrecognizedSameSiteCookies:function(e){return this.isChromiumBased(e)&&this.isChromiumVersionAtLeast(51,e)&&!this.isChromiumVersionAtLeast(67,e)||this.isUcBrowser(e)&&!this.isUcBrowserVersionAtLeast(12,13,2,e)},regexContains:function(e,o){return null!==e.match(o)},extractRegexMatch:function(e,o,t){var n=e.match(o);return null!==n&&void 0!==n[t]?n[t]:null},isIosVersion:function(e,o){return this.extractRegexMatch(o,/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//,1)===this.intToString(e)},isMacosxVersion:function(e,o,t){var n=/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//;return this.extractRegexMatch(t,n,1)===this.intToString(e)&&this.extractRegexMatch(t,n,2)===this.intToString(o)},isSafari:function(e){return null!==e.match(/Version\/.* Safari\//)&&!this.isChromiumBased(e)},isMacEmbeddedBrowser:function(e){return this.regexContains(e,/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/)},isChromiumBased:function(e){return this.regexContains(e,/Chrom(e|ium)/)},isChromiumVersionAtLeast:function(e,o){return e<=this.stringToInt(this.extractRegexMatch(o,/Chrom[^ /]+\/(\d+)[.\d]* /,1))},isUcBrowser:function(e){return this.regexContains(e,/UCBrowser\//)},isUcBrowserVersionAtLeast:function(e,o,t,n){var i=/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /,a=this.stringToInt(this.extractRegexMatch(n,i,1)),r=this.stringToInt(this.extractRegexMatch(n,i,2)),s=this.stringToInt(this.extractRegexMatch(n,i,3));return a!==e?e<a:r!==o?o<r:t<=s},getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,t,n,i,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var r="",s=function(e){if(e===1/0)return"Fri, 31 Dec 9999 23:59:59 GMT";var o=new Date;return o.setTime(o.getTime()+1e3*e),o.toGMTString()};if(t)switch(t.constructor){case Number:r="; expires="+s(t)+t===1/0?"":"; max-age="+t;break;case String:r="; expires="+t;break;case Date:r="; expires="+t.toUTCString()}"lr-user--token"===e&&(a=!0);var l=navigator.userAgent;return"lr-session-token"===e&&this.isSameSiteNoneCompatible(l)?document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+";secure;SameSite=None":document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+(a?"; secure":""),!0},removeItem:function(e,o,t){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; domain="+t:"")+(o?"; path="+o:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=e.length,t=0;t<o;t++)e[t]=decodeURIComponent(e[t]);return e}},LRNameSpace.Utilities=function(){var e=navigator.userAgent.toLowerCase(),t={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:(/msie/.test(e)||/trident/.test(e))&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},i=!1,a=!1,n=[];function r(){if(!a&&(a=!0,n)){for(var e=0;e<n.length;e++)n[e].call(window,[]);n=[]}}function s(){var n,e,o;i||(i=!0,document.addEventListener&&!t.opera&&document.addEventListener("DOMContentLoaded",r,!1),t.msie&&window===top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(e){return}r()}}(),t.opera&&document.addEventListener("DOMContentLoaded",function(){if(!a){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return;r()}},!1),t.safari&&function(){if(!a&&("loaded"===document.readyState||"complete"===document.readyState)){if(void 0===n){for(var e=document.getElementsByTagName("link"),o=0;o<e.length;o++)"stylesheet"===e[o].getAttribute("rel")&&n++;var t=document.getElementsByTagName("style");n+=t.length}document.styleSheets.length===n&&r()}}(),e=r,o=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){o&&o(),e()})}return{browser:t,getHashParam:function(e){var o=window.location.hash.match(new RegExp(e+"=([^&]*)")),t=window.location.hash&&null!=o?o[1]:this.getQueryParameterByName(e);return t},keysToLowerCase:function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).toLowerCase()]=e[o],"object"==typeof i[o.toLowerCase()]&&null!=i[o.toLowerCase()]&&(i[o.toLowerCase()]=this.keysToLowerCase(i[o.toLowerCase()]));return i},elementsByClass:function(e,o){if(""!==e){o=o||document.body;for(var t=[],n=new RegExp("(^| )"+e+"( |$)"),i=o.getElementsByTagName("*"),a=0,r=i.length;a<r;a++)n.test(i[a].className)&&t.push(i[a]);return t}},isValidUrl:function(e){return!!/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(e)},hasClass:function(e,o){return e.className.match(new RegExp("(\\s|^)"+o+"(\\s|$)"))},addclass:function(e,o){return!this.hasClass(e,o)&&(e.className+=" "+o,!0)},isSubstring:function(e,o){for(var t in o)if(-1!==o[t].indexOf(e))return t;return!1},isJsonString:function(e){try{return JSON.parse(e)}catch(e){return!1}},addEvent:function(e,o,t){var n=[];o instanceof Array?n=o:n.push(o);for(var i=0;i<n.length;i++)n[i]["on"+e]=t},getQueryParameterByName:function(e,o){o="&"+(o||location.search),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(o);return null==t?null:decodeURIComponent(t[1].replace(/\+/g," "))},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},getQueryStringValue:function(e,o){var t=e||window.location.href,n=new RegExp("[?&]"+o+"=([^&#]*)","i").exec(t);return n?n[1]:null},extend:function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])},ready:function(e,o){s(),a?e.call(window,[]):n.push(function(){return e.call(window,[])})},parseQueryString:function(e){var o={};if((e||""!==e)&&"string"==typeof e)for(var t=e.split("&"),n=0;n<t.length;n++){var i=t[n].split("=");o[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return o},encodedString:function(e){return-1===e.indexOf("%2B")&&(e=e.replace(/\+/g,"%2B")),e},mergeOptions:function(e,o){var t,n,i={};for(t in e)i[t]=e[t];for(n in o)i[n]=o[n];return i},mergeObjects:function(e,o,t){var n,i,a=[];for(i in e){for(var r in o)n=t?o[r]===e[i]:o[r].name===e[i].name;if(n)break;a.push(e[i])}return a=a.concat(o)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},randomString:function(e){var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e=e||Math.floor(Math.random()*o.length);for(var t="",n=0;n<e;n++)t+=o[Math.floor(Math.random()*o.length)];return t},findInSchema:function(e,o,t,n){for(var i=0;i<e.length;i++){if((n?e[i]&&e[i][o].toLowerCase():e[i]&&e[i][o])===t)return e[i]}return null},jsonToQueryString:function(o){return Object.keys(o).map(function(e){return o[e]?encodeURIComponent(e)+"="+encodeURIComponent(o[e]):""}).join("&")},insertBefore:function(e,o){o.parentNode.insertBefore(e,o)},isEmpty:function(e){for(var o in e)if(e.hasOwnProperty(o))return!1;return!0},keyslowerToUpperCamelCase:function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).charAt(0).toUpperCase()+o.substr(1)]=e[o];return i},findElementByRegex:function(e,o,t){for(var n=t?document.querySelectorAll(t):document.querySelectorAll("*"),i=[],a=0;a<n.length;a++)o.test(n[a][e])&&i.push(n[a]);return i},isObject:function(e){return e instanceof Object&&e.constructor===Object},parseString:function(e){return void 0!==e&&JSON.parse(e)},containsObject:function(e,o,t){if(t){for(var n=0;n<e.length;n++)if(e[n][t]===o[t])return!0;return!1}}}},LRNameSpace.ProgressiveProfiling=function(y,v,C,w){return{fetchSchema:function(e){y.util.ajaxCall("get",w.configApiDomain+"progressiveProfilingSchema?apikey="+y.options.apiKey+"&appName="+y.options.appName,"",e)},execStep:function(c,e){var p,d,m,g,f,h;y.progressiveProfilingSchema&&(p=e.onSuccess||function(){},d=e.onError||function(){},m=e.container||"",g=e.classPrefix||"",f=e.templateName||"",(h=y.storage.getBrowserStorage(w.storedTokenName))&&y.util.ajaxCall("get",w.apiDomain+"/auth/socialidentity?apiKey="+y.options.apiKey+"&access_token="+h,"",function(e){var o,t,n,i,a,r,s,l,u=y.util.findInSchema(y.progressiveProfilingSchema.ProfilingSteps,"Step",c);u?((o={}).Profile=e,o.access_token=h,"email"===(t=e.Provider.toLowerCase())||"raas"===t||y.options.progressiveProfilingTraditional?(y.options.progressiveProfilingTraditional&&"email"!==t&&"raas"!==t&&(e=y.LoggedinSocialProvderProfile),n=u.Schema,i=v.mapSchema(n,e,null,!0),o.Profile=e,0<i.length?v.createForm(i,"progressiveProfiling",m,function(e){C.updateData(o,m,e,p,d,g,i,"progressiveProfiling")},function(e){d(e)},g):v.loginHandleToken(o,"",p,d)):(a=u.Scopes,(r=y.util.findInSchema(a,"Provider",t,!0))?(s="https://"+(y.options.customDomain||y.options.appName+"."+w.hubDomain)+"/RequestHandlor.aspx?apikey="+y.options.apiKey+"&provider="+t+"&scope="+r.Scopes,(l=[]).push({Name:t,Endpoint:s}),v.renderCustomInterface(m,"",f,"","",l),v.socialLogin(m,p,d)):v.loginHandleToken(o,"",p,d))):y.log("Step Schema not found.")}))}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var o=this.length>>>0,t=Number(arguments[1])||0;for((t=t<0?Math.ceil(t):Math.floor(t))<0&&(t+=o);t<o;t++)if(t in this&&this[t]===e)return t;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(null==this)throw new TypeError;var o=Object(this),t=o.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n,i=[],a=arguments[1],r=0;r<t;r++){r in o&&(n=o[r],e.call(a,n,r,o)&&i.push(n))}return i}),function(i){"use strict";var e={get:function(e){var o=n();return e?o[e]:o},add:function(e){var o,t=n();for(o in e)t[o]=e[o];a(t)},remove:function(e){e="string"==typeof e?[e]:e;for(var o=n(),t=0;t<e.length;t++)delete o[e[t]];a(o)},clear:function(){a({})}};function n(){for(var e=i.location.hash?i.location.hash.substr(1).split("&"):[],o={},t=0;t<e.length;t++){var n=e[t].split("=");o[n[0]]=decodeURIComponent(n[1])}return o}function a(e){var o,t=[];for(o in e)t.push(o+"="+encodeURIComponent(e[o]));i.location.hash=t.join("&")}i.hash=e}(window),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},writable:!0,configurable:!0});var LoginRadiusDefaults={idPrefix:"loginradius-",classPrefix:"loginradius-",apiDomain:"https://api.loginradius.com/identity/v2",hubDomain:"hub.loginradius.com",cloudApiDomain:"https://cloud-api.loginradius.com/",configApiDomain:"https://config.lrcontent.com/ciam/",socialApiDomain:"https://api.loginradius.com/api/v2/",externalLibrary:"https://auth.lrcontent.com/v2/external-libs/",isRegFormSchemaLock:!1,isSecurityFormSchemaLock:!1,innerHTML:!1,autoFilledFieldforPasswordLesLogin:!1,socialRegFormId:"",lrResponseCounter:0,LRPhoneNo:"",lrCounterJwtResponse:"",lrCounterTokenResponse:"",storedTokenName:"LRTokenKey",storedTwoFAToken:"lr2fatok",storedSessionTokenData:"lrSessionTokenObj",storedOTPAuth:"lrotpauthver",storedGAAuth:"lrgaauthver",storedUidName:"lr-user-uid",tokenCookie:"lr-user--token",isSSOInitFired:!1,pingCount:1,messages:{tokenValid:{Message:"Access token is not valid",Description:"LoginRadius Access Token is invalid, please verify the authentication response",ErrorCode:905},twofaTokenValid:{Message:"Token is not valid",Description:"Your session is not valid."},twofaGAAuthDisable:{Message:"Already Disabled",Description:"Google authenticator is already disabled."},twofaOTPAuthDisable:{Message:"Already Disabled",Description:"OTP authenticator is already disabled."},twofaAuthRequired:{Message:"Cannot Disable",Description:"Two factor authentication is required, So atleast one authenticator should be required."},invalidEmail:{Message:"Invalid Email",Description:"The email entered is not a valid email."},invalidPhone:{Message:"Invalid Phone",Description:"The mobile number entered is not valid."},disabledAccountLinking:"Account Linking disabled in your account",noSecurityQuestions:"There are no security questions for this application",invalidSott:"Something went wrong, please try again.",notValidMessage:"Error Message element not valid",passwordStrengthMessage:"Password strength meter configuration is not valid.",otpSent:"OTP Sent Successfully",vTokenError:{Message:"Verification token not found in query string."},notFound:"Data not found.",emailNotVerified:{Message:"The email is not verified, please verify the link in your email",Description:"The email is not verified, please verify the link in your email",ErrorCode:970},phoneNotVerified:{Message:"Phone number is not verified",Description:"The provided phone number is not verified, please use a verified phone number for login.",ErrorCode:1066},blockedUser:{Message:"User is blocked",Description:"This user is blocked by site admin",ErrorCode:991},unverifiedUser:{Message:"This Uid have only traditional unverified account",Description:"This Uid have only traditional unverified account",ErrorCode:1028}},buttonNames:{login:"Login",socialregistration:"Login",loginrequiredfieldsupdate:"Login",registration:"Register",verifyemail:"Verify",resetpassword:"Reset Password",resetpin:"Reset PIN",sociallogin:"Login",otp:"Verify",twofaotp:"Verify",showqrcode:"Verify",updatephone:"Update",changephone:"Update",forgotpassword:"Send",forgotpin:"Send",securityquestions:"Get",changepassword:"Submit",changepin:"Change PIN",resendemailverification:"Send",addemail:"Send",removeemail:"Send",changeusername:"Submit",profileeditor:"Update Profile",otplogin:"OTP",passwordlessloginbuttonlabel:"Email me a link to Sign In",passwordlessloginotpbuttonlabel:"Send an OTP to Sign In",createtwofactorauthentication:"2-Step Verification",sendotp:"Send OTP",resendotp:"Resend OTP",changenumber:"Change Number",backupcode:"Login",backupcodebutton:"Try another way to Sign In",backupcodebackbutton:"Back",generatebackupcodebutton:"Generate Backup Codes",disablegoogleauthenticator:"Disable Google Authenticator",disableotpauthenticator:"Disable OTP Authenticator",updatesecurityquestion:"Update Security Question",resetpwdbysecq:"Reset Password By SecurityQ",resetpinbysecq:"Reset PIN By SecurityQ",smartlogin:"Smart Login",validatecode:"Validate",onetouchlogin:"Login",progressiveprofiling:"Progressive Profiling",privacypolicyupdate:"Accept",updatephone2fa:"Update",pinsetup:"Set Pin",pinlogin:"Login",pinreauthentication:"Verify",pinloginbackbtn:"Back",consentlogin:"Submit Consent",customeventconsent:"Submit Consent",consenteditor:"Submit Consent",resetBackupCode:"Reset Backup Code"},templates:{consentMainTemplate:"loginradius_consent_custom_tmpl",consentGroupTemplate:"loginradius_consent_group_tmpl",consentOptionTemplate:"loginradius_consent_option_tmpl"},options:{passwordlessLoginEmailTemplate:"",callbackUrl:window.location,callbackInsideSameWindow:"",callbackType:"",scope:"",loginUrl:"",deleteUrl:"",emailTemplate:"",verificationUrl:"",verificationEmailTemplate:"",resetPasswordEmailTemplate:"",resetPINEmailTemplate:"",resetPasswordConfirmationEmailTemplate:"",resetPINConfirmationEmailTemplate:"",smartLoginRedirectUrl:"",autoLoginRedirectUrl:"",smartLoginEmailTemplate:"",autoLoginEmailTemplate:"",smsTemplate2FA:"",smsTemplateForgot:"",smsTemplateWelcome:"",smsTemplateOneTouchLoginWelcome:"",smsTemplateOneTouchLogin:"",passwordlessLoginSMSTemplate:"",smsTemplate2FAWelcome:"",smsTemplatePhoneVerification:"",smsTemplateUpdatePhone:"",welcomeEmailTemplate:"",onetouchLoginEmailTemplate:"",deleteUserEmailTemplate:"",onetouchLoginRedirectUrl:"",resetPasswordUrl:"",resetPINUrl:"",templateName:"",debugMode:!1,tokenType:"lrtoken",integrationName:"",smartLoginPingCount:100,smartLoginPingInterval:5,crossDeviceSSOPingCount:100,crossDeviceSSOPingInterval:5,maskSensitiveInput:!1,enableHeaderSott:!0,accessTokenResponse:!0,rbaOneclickEmailTemplate:"",rbaOTPSmsTemplate:"",rbaCityEmailTemplate:"",rbaCountryEmailTemplate:"",rbaBrowserEmailTemplate:"",rbaIpEmailTemplate:"",rbaCitySmsTemplate:"",rbaCountrySmsTemplate:"",rbaBrowserSmsTemplate:"",rbaIpSmsTemplate:"",setLRSession:!1,askOptionalFieldsOnProgressiveSteps:!0,disableResendOTPButton:!1,disableResendOTPButtonDelay:5},regexExpression:{emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,phoneRegex:/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{8,14}$/},_uuidFormat:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i};function LoginRadiusUtility(v,C){var p=LoginRadiusDefaults.buttonNames,w=new LRNameSpace.Utilities,d=this;d.elementById=function(e,o){var t=document.getElementById(e);if(t)return t;o||v.log("Unable to find id: "+e)},d.getThisObjectName=function(){for(var e in v.global)if("frameElement"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&v.global[e]===v)return e},d.serialize=function(e,o){if(e&&"FORM"===e.nodeName){for(var t,n=[],i=e.elements.length-1;0<=i;--i)if(""!==e.elements[i].name&&(o||""!==e.elements[i].value.trim()))switch("emailid"!==e.elements[i].name||v.options.usernameLogin||v.options.duplicateEmailWithUniqueUsername||(e.elements[i].value=e.elements[i].value.toLowerCase()),e.elements[i].nodeName){case"INPUT":switch(e.elements[i].type){case"text":case"hidden":case"button":case"reset":case"submit":case"email":var a=e.elements[i].name;"emailid"===a&&(a="email"),e.elements[i].disabled||n.push(a+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"password":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value));break;case"checkbox":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].checked));break;case"radio":e.elements[i].checked&&n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value))}break;case"TEXTAREA":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"SELECT":switch(e.elements[i].type){case"select-one":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"select-multiple":for(t=e.elements[i].options.length-1;0<=t;--t)e.elements[i].options[t].selected&&n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].options[t].value.trim()))}break;case"BUTTON":switch(e.elements[i].type){case"reset":case"submit":case"button":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()))}}return n.join("&")}},d.addJs=function(e,o){var t=(o=o||document).getElementsByTagName("head")[0],n=o.createElement("script");return n.src=e,n.type="text/javascript",t.appendChild(n),n},d.hashTmpl=function e(o,t){var n=/\W/.test(o)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").split("<#").join("\t").replace(/((^|#>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)#>/g,"',$1,'").split("\t").join("');").split("#>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[o]=i[o]||(d.elementById(o)?e(d.elementById(o).innerHTML):"");return"function"==typeof n?t?n(t):n:""};var i={};d.tmpl=function e(o,t){var n=/\W/.test(o)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[o]=i[o]||(d.elementById(o)?e(d.elementById(o).innerHTML):"");return"function"==typeof n?t?n(t):n:""},d.jsonpCall=function(e,o,t,n){v.$hooks.call("startProcess",n);var i=t||"Loginradius"+Math.floor(1e18*Math.random()+1);window[i]=function(e){o(e),v.$hooks.call("endProcess",n)};var a=-1!==e.indexOf("?")?e+"&callback="+i:e+"?callback="+i;d.addJs(a)},d.getButtonAttribute=function(e,o){var t,n=o||LoginRadiusDefaults.idPrefix;return v.buttonElements[e]?t=(t=v.buttonElements[e]).cloneNode(!0):((t=document.createElement("input")).type="button",t.value=v.buttonsName[e]||p[e]),t.id=n+"button-"+e,t},d.ajaxCall=function(e,o,i,a,r,s){var l=this,u=r;if(r&&-1!==r.indexOf("##")&&(u=r.split("##")[1]),LoginRadiusDefaults._uuidFormat.test(C.apiKey)){v.$hooks.call("startProcess",r,i);try{var c=new XMLHttpRequest;if(v.options.projectionFields&&r){var t=Object.keys(v.options.projectionFields),n=["verifyOTP","updateData"],p=!1,d=r;if(v.LRCheckRegistration?(p=-1!==n.indexOf(r),d="registration"):v.LRCheckLogin&&(p=-1!==n.indexOf(r),d="login"),-1!==t.indexOf(r)||p){var m=v.options.projectionFields[d];if(m&&0<m.length){var g=["ErrorCode","Profile/Uid","Profile/IsDeleted","access_token","Profile/EmailVerified","Profile/PhoneIdVerified","Profile/PhoneId","PhoneId","PhoneIdVerified","EmailVerified","Uid","IsDeleted"];(v.options.twoFactorAuthentication||v.options.optionalTwoFactorAuthentication)&&g.push("SecondFactorAuthentication/SecondFactorAuthenticationToken","SecondFactorAuthentication/IsOTPAuthenticatorVerified","SecondFactorAuthentication/IsGoogleAuthenticatorVerified","SecondFactorAuthentication/OTPPhoneNo","SecondFactorAuthentication/ManualEntryCode"),m=w.mergeObjects(m,g,!0);for(var f="&fields=",h=0;h<m.length;h++)h===m.length-1?f+=m[h]:f=f+m[h]+",";o+=f}}}var y=v.util.getQueryParameterByName("access_token",o);v.options.passAccessTokenInHeader&&y&&-1<o.indexOf(LoginRadiusDefaults.apiDomain)||-1!==["setCustomToken","setToken"].indexOf(r)?(o=o.replace("&access_token="+y,"").replace("?access_token="+y+"&","?").replace("?access_token="+y,"?"),c.open(e,o,!0),c.setRequestHeader("Authorization","Bearer "+y)):c.open(e,o,!0),(-1<o.indexOf("/ssologin/")||"setToken"===r)&&(c.withCredentials=!0),-1===o.indexOf("cdn")&&-1===o.indexOf(".json")&&c.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.sottcheck&&(c.setRequestHeader("X-LoginRadius-Sott",v.options.sott),delete i.sottcheck),i?(i="string"==typeof i||i instanceof String?JSON.stringify(w.parseQueryString(i)):JSON.stringify(i),c.setRequestHeader("Content-Type","application/json"),c.send(i)):c.send(null),c.onreadystatechange=function(){var e,o,t,n;4===c.readyState&&((e=c.response)&&(o=JSON.parse(e),-1<Object.keys(o).map(function(e){return e.toLowerCase()}).indexOf("errorcode")?v.$hooks.call("xhrEndWithError",r):v.$hooks.call("xhrEndWithSuccess",r)),"500"==c.status&&((t=JSON.parse(e)).ErrorCode="500",e=JSON.stringify(t),v.$hooks.call("xhrEndWithError",r)),(n=l.isJsonString(e))&&(v.$hooks.call("successCallback",u,n,i),s?a(s,n):a(n)),v.$hooks.call("endProcess",r))},c.onerror=function(){v.$hooks.call("xhrEndWithError",r)}}catch(e){}}else v.log("apiKey is not in valid guid format.")},d.openWindow=function(e){if(e=e||d.href,!v.options.isMobile){var o=document.createElement("a");o.href=e;var t=w.getQueryParameterByName("provider",o.search),n="";v.options.noCallbackForSocialLogin&&(e+="&nocallback=true&callbackguid="+(n=v.util.randomString(16)));var i=v.options.customizeSocialPopup||"menubar=1,resizable=1,width=450,height=450,scrollbars=1";return window.open(e,"lrpopupchildwindow",i),v.$hooks.call("socialCalls",t,n),!1}var a="no";v.options.debugMode&&(a="yes");var r=window.open(e,"_blank","location="+a);r.addEventListener("loadstop",function(e){var o,t=null===(o=new RegExp("[\\?&]"+"token"+"=([^&#]*)").exec(e.url))?"":decodeURIComponent(o[1].replace(/\+/g," "));null!=t&&""!==t&&(r.close(),html5passToken(t))})},d.addHTMLContent=function(e,o,t,n,i){t=t||!1;var a,r,s,l=d.elementById(e);if(l||n){t||(l.innerHTML=""),n?(a=p[n.toLowerCase()],r=i||LoginRadiusDefaults.idPrefix,s=d.elementById(r+"submit-"+a.toLowerCase().replace(/ /g,"-")),w.insertBefore(o,s)):l.appendChild(o)}else{var u=w.elementsByClass(e);if(u&&0<u.length)for(var c=0;c<u.length;c++)t||(u[c].innerHTML=""),u[c].appendChild(o)}},d.addRecaptchaJS=function(e){window.grecaptcha||!v.options.v2Recaptcha&&!e?!window.grecaptcha&&v.options.invisibleRecaptcha&&d.addJs("https://www.google.com/recaptcha/api.js"):v.options.v2RecaptchaLanguage?d.addJs("https://www.google.com/recaptcha/api.js?render=explicit&hl="+v.options.v2RecaptchaLanguage):d.addJs("https://www.google.com/recaptcha/api.js?render=explicit"),(v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)&&d.addJs("https://ssl.captcha.qq.com/TCaptcha.js")},d.renderV2Recaptcha=function(t,e,n){var i,o,a=d.elementById(t);(v.options.v2Recaptcha||e||v.options.invisibleRecaptcha||v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)&&(window.grecaptcha&&a&&a.innerHTML&&grecaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]),o=setInterval(function(){i||(i=setInterval(function(){var e,o;window.grecaptcha?a&&""===a.innerHTML&&(e={sitekey:v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3",theme:"light",callback:function(e){a.style.display="block",n&&n(e)}},v.options.invisibleRecaptcha&&(e.size="invisible",e.callback="onCaptchaSubmit"),window[t+"lr_recaptcha_widgets_idprefix"]=grecaptcha.render(t,e),clearInterval(i)):(t+="_tencent",(o=document.getElementById(t))&&(o.style.display="block"),"undefined"!=typeof TencentCaptcha&&new TencentCaptcha(document.getElementById(t)),clearInterval(i))},1e3),clearInterval(o))},1e3))},d.captchaSchema=function(e,o,t,n){var i,a,r;!v.options.v2Recaptcha&&!t||d.elementById(e)?v.options.invisibleRecaptcha&&!d.elementById(e)&&(i={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" style="'+("hide"===t?"display:none":"")+'" class="g-recaptcha" data-sitekey="'+(v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3")+'" data-size="invisible" data-callback="onCaptchaSubmit"></div>',display:"Captcha",rules:""},o.push(i)):(a={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" class="recaptcha_widget"></div>',display:"Captcha",rules:"required"},o.push(a)),d.elementById(e)||!v.options.tencentCaptcha&&!v.options.tencentCaptchaAsFallback||(window.onTencentCaptchaSubmit=function(e){0==e.ret&&(n?n(e):window.onTencentCaptchaSubmitCallback(e))},r={type:"captcha",name:"TencentCaptcha",html:"<div "+(t?"style=display:none; ":"")+' id= "'+e+'_tencent"  class="TencentCaptcha"  data-appid="'+v.options.tencentCaptchaAppid+'" data-cbfn="onTencentCaptchaSubmit"></div>',display:"Captcha",rules:""},o.push(r))},d.checkPhoneOrEmailLogin=function(e){var o,t=w.parseQueryString(e);return(t.emailid||t.email)&&(v.options.duplicateEmailWithUniqueUsername&&!t.username?e=e.replace("emailid","username").replace("email","username"):(o=t.emailid||t.email,LoginRadiusDefaults.regexExpression.emailRegex.test(o)?e=e.replace("emailid","email"):v.options.phoneLogin&&LoginRadiusDefaults.regexExpression.phoneRegex.test(o)?(e=e.replace("emailid","phone").replace("email","phone"),e+="&phoneApi=1"):v.options.usernameLogin&&(e=e.replace("emailid","username").replace("email","username")))),e},d.disableResendOTPButton=function(e){var o=v.options.disableResendOTPButtonDelay,t=e.target;t&&(t.disabled=!0,setTimeout(function(){t.disabled=!1},1e3*o))}}function LoginRadiusApiFramework(c,p){var e=this;e.init=function(){c.lrApiFramework=!0},e.login=function(e,o,t){c.getAppConfiguration(function(){p.loginController(c.util.jsonToQueryString(e),null,o,t)})},e.otpLogin=function(e,o,t){c.getAppConfiguration(function(){p.loginOTPController(c.util.jsonToQueryString(e),null,o,t)})},e.twoFALogin=function(e,o,t,n,i,a,r,s){n=n||function(){},r=r||function(){},s=s||function(){},i=i||function(){},a=a||function(){};c.getAppConfiguration(function(){p.login2FAController(c.util.jsonToQueryString(e),null,o,t,"",r,s,n,i,a)})},e.registration=function(e,o,t,n,i,a){i=i||function(){},a=a||function(){};c.getAppConfiguration(function(){p.registrationController(o,null,t,n,"",e,i,a)})},e.forgotPassword=function(e,o,t){c.getAppConfiguration(function(){p.forgotPasswordController(c.util.jsonToQueryString(e),"",o,t)})},e.forgotPIN=function(e,o,t){c.getAppConfiguration(function(){p.forgotPINController(c.util.jsonToQueryString(e),"",o,t)})},e.resetPassword=function(e,o,t){c.getAppConfiguration(function(){p.resetPasswordController(c.util.jsonToQueryString(e),o,t)})},e.resetPIN=function(e,o,t){c.getAppConfiguration(function(){p.resetPINController(c.util.jsonToQueryString(e),o,t)})},e.emailVerification=function(e,o,t){c.getAppConfiguration(function(){p.emailVerificationController(e.vtoken,o,t)})},e.socialLogin=function(e,o,t,n,i,a){c.getAppConfiguration(function(){c.LoginRadiusHostedPage&&c.SSOinitFired||(n=n||function(){},i=i||function(){},p.socialLoginReceiveToken(e.token,a,o,t,null,n,i))})},e.resendEmailVerification=function(e,o,t){c.getAppConfiguration(function(){p.resendEmailVerificationController(c.util.jsonToQueryString(e),o,t)})},e.twoFAResendOTP=function(e,o,t){c.getAppConfiguration(function(){p.resendOTP2FAController(c.util.jsonToQueryString(e),o,t)})},e.twoFAVerifyOTP=function(e,o,t){c.getAppConfiguration(function(){p.verify2FAOTPController(c.util.jsonToQueryString(e),o,t)})},e.twoFAUpdatePhone=function(e,o,t,n,i,a,r){n=n||function(){},i=i||function(){},a=a||function(){},r=r||function(){};c.getAppConfiguration(function(){p.update2FAPhoneNumberController(e,null,o,t,null,n,i,a,r)})},e.updatePhone=function(e,o,t,n,i,a,r){a=a||function(){},r=r||function(){},n=n||function(){},i=i||function(){};c.getAppConfiguration(function(){p.updatePhoneNumberController(c.util.jsonToQueryString(e),null,o,t,null,a,r,n,i)})},e.verifyOTP=function(e,o,t,n){c.getAppConfiguration(function(){p.verifyOTPController(e,o,t,n)})},e.resendOTP=function(e,o,t){c.getAppConfiguration(function(){p.resendOTPController(c.util.jsonToQueryString(e),o,t)})},e.addEmail=function(e,o,t){c.getAppConfiguration(function(){p.addEmailController(c.util.jsonToQueryString(e),o,t)})},e.removeEmail=function(e,o,t){c.getAppConfiguration(function(){p.removeEmailController(c.util.jsonToQueryString(e),o,t)})},e.changeUsername=function(e,o,t){c.getAppConfiguration(function(){p.changeUsernameController(c.util.jsonToQueryString(e),o,t)})},e.changePassword=function(e,o,t){c.getAppConfiguration(function(){p.changePasswordController(c.util.jsonToQueryString(e),o,t)})},e.changePIN=function(e,o,t){c.getAppConfiguration(function(){p.changePINController(c.util.jsonToQueryString(e),o,t)})},e.checkPhoneNumberAvailability=function(e,o,t){c.getAppConfiguration(function(){p.checkPhoneNumberAvailabilityController(c.util.jsonToQueryString(e),o,t)})},e.resetPasswordByPhone=function(e,o,t){c.getAppConfiguration(function(){p.resetPasswordByPhoneController(c.util.jsonToQueryString(e),o,t)})},e.resetPINByPhone=function(e,o,t){c.getAppConfiguration(function(){p.resetPINByPhoneController(c.util.jsonToQueryString(e),o,t)})},e.forgotPasswordbyPhone=function(e,o,t){c.getAppConfiguration(function(){p.forgotPasswordbyPhoneController(c.util.jsonToQueryString(e),null,o,t)})},e.forgotPINbyPhone=function(e,o,t){c.getAppConfiguration(function(){p.forgotPINbyPhoneController(c.util.jsonToQueryString(e),null,o,t)})},e.updateData=function(e,o,t,n,i,a){var r=n,s=i,l={};"object"==typeof n&&(l=n,r=i,s=a);var u={};u.Profile=l,u.access_token=t;c.getAppConfiguration(function(){p.updateData(u,null,o,r,s,"",e)})},e.checkEmailAvailability=function(e,o,t){c.getAppConfiguration(function(){p.checkEmailAvailabilityController(c.util.jsonToQueryString(e),o,t)})},e.checkUserNameAvailability=function(e,o,t){c.getAppConfiguration(function(){p.checkUserNameAvailabilityController(c.util.jsonToQueryString(e),o,t)})},e.resetPasswordBySecurityQuestion=function(e,o,t){c.getAppConfiguration(function(){p.resetPasswordBySecurityQuestionController(c.util.jsonToQueryString(e),o,t)})},e.resetPINBySecurityQuestion=function(e,o,t){c.getAppConfiguration(function(){p.resetPINBySecurityQuestionController(c.util.jsonToQueryString(e),o,t)})},e.updateSecurityQuestion=function(e,o,t){c.getAppConfiguration(function(){p.updateSecurityQuestionController(c.util.jsonToQueryString(e),o,t)})},e.resetTwoFactor=function(e,o,t){c.getAppConfiguration(function(){p.resetTwoFactorAuthenticationController(e,o,t)})},e.invalidateToken=function(e,o,t){c.getAppConfiguration(function(){p.invalidateToken(e,o,t)})},e.validateToken=function(e,o,t){c.getAppConfiguration(function(){p.validateToken(e,o,t)})},e.getSocialData=function(e,o,t,n,i){c.getAppConfiguration(function(){p.getSocialDataController(e,o,t,n,i)})},e.postSocialData=function(e,o,t,n,i,a){c.getAppConfiguration(function(){p.postSocialDataController(e,o,t,n,i,a)})},e.getCustomObjects=function(e,o,t){c.getAppConfiguration(function(){p.getCustomObjectsController(e,o,t)})},e.createCustomObject=function(e,o,t,n){c.getAppConfiguration(function(){p.createCustomObjectController(e,o,t,n)})},e.getCustomObjectById=function(e,o,t,n){c.getAppConfiguration(function(){p.getCustomObjectByIdController(e,o,t,n)})},e.deleteCustomObjectById=function(e,o,t,n){c.getAppConfiguration(function(){p.deleteCustomObjectController(e,o,t,n)})},e.updateCustomObjectById=function(e,o,t,n,i,a){c.getAppConfiguration(function(){p.updateCustomObjectController(e,o,t,a,n,i)})},e.getBackupCode=function(e,o,t){c.getAppConfiguration(function(){p.getBackupCodeController(e,o,t)})},e.resetBackupCode=function(e,o,t){c.getAppConfiguration(function(){p.resetBackupCodeController(e,o,t)})},e.autoLogin=e.smartLogin=function(e,o,t){c.getAppConfiguration(function(){p.smartLoginController(c.util.jsonToQueryString(e),o,t)})},e.verifyConsent=function(e,o,t){c.getAppConfiguration(function(){p.verifyConsentController(e,o,t)})},e.fetchConsentLogs=function(e,o){c.getAppConfiguration(function(){p.consentLogsController(e,o)})},e.updateConsents=function(e,o,t){c.getAppConfiguration(function(){p.updateConsentController(e,o,t)})},e.submitConsentbyConsentToken=function(e,o,t){var n=e.consentToken?e.consentToken:"";n?c.getAppConfiguration(function(){p.submitConsentController(n,e,o,t)}):(t({response:"consentToken is required parameter"}),c.log("consentToken is required parameter"))},e.submitConsentbyAccesToken=function(e,o,t){c.getAppConfiguration(function(){p.customEventConsentController(e,o,t)})}}function setLoginRadiusDefaultSchema(e){e.loginFormSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.backupCodeFormSchema=[{type:"string",name:"backupcode",display:"Backup Code",rules:"required",permission:"r"}],e.resetPasswordByPhoneSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.resetPINByPhoneSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"},{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"}],e.checkPhoneNumberSchema=[{type:"string",name:"phone",display:"Phone Number",rules:"required|valid_phoneno",permission:"r"}],e.QRCodeSchema=[{type:"string",name:"googleAuthenticatorCode",display:"Google Authenticator Code",rules:"required",permission:"r"}],e.getSecQSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"}],e.otpSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"}],e.forgotPasswordFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.forgotPINFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.smartLoginSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required",permission:"r"}],e.passwordLessLoginSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"},{type:"string",name:"name",display:"Name",rules:"",permission:"r"}],e.changePasswordFormSchema=[{type:"password",name:"oldpassword",display:"Old Password",rules:"required",permission:"w"},{type:"password",name:"newpassword",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmnewpassword",display:"Confirm Password",rules:"required|min_length[6]|max_length[32]|matches[newpassword]",permission:"w"}],e.emailSchema=e.forgotPasswordFormSchema,e.addEmailSchema=[{type:"string",name:"emailid",display:"Email",rules:"required|valid_email",permission:"r"},{type:"string",name:"type",display:"Type",rules:"required",permission:"r"}],e.changeUsernameFormSchema=[{type:"string",name:"username",display:"Username",rules:"required",permission:"r"}],e.changePINFormSchema=[{type:"password",name:"oldpin",display:"Old PIN",rules:"required",permission:"w"},{type:"password",name:"newpin",display:"PIN",rules:"required",permission:"w"},{type:"password",name:"confirmnewpin",display:"Confirm PIN",rules:"required|matches[newpin]",permission:"w"}],e.resetPasswordFormSchema=[{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmpassword",display:"Confirm Password",rules:"required|matches[password]|min_length[6]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.resetPINFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"},{type:"password",name:"confirmpin",display:"Confirm PIN",rules:"required|matches[pin]|min_length[4]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.pinLoginFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required",permission:"r"}],e.privacyPolicySchema=[{type:"multi",name:"acceptprivacypolicy",display:"I agree to the terms of service",rules:"",permission:"r"}],e.btnOTPSchema={type:"button",name:"click",display:"click",rules:"",permission:"r",event:"click",eventCallback:function(){}},e.defaultBtnSchema={type:"button",name:"default",display:"default",rules:"",permission:"r",event:"click",eventCallback:function(){}}}function setLoginRadiusModuleFunctions(d,m){var g=LoginRadiusDefaults.options,f=new SetLoginRadiusCommonFunctions(d),e=new LoginRadiusControllers(d,f),h=d.util;d.version="3.15.0",d.LRCheckRegistration=!1,d.passwordlessLoginFlag=!1,d.socialLoginFlag=!1,d.LRCheckLogin=!1,d.LRCheck2FA=!1,d.loginAction=!1,d.options="",d.consentOptions="",d.sessionData={getUid:function(){return d.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)},getToken:function(){return d.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)}},d.errorMessages=[],d.validationMessages=[],d.formCustomLabel={},d.formElementsTitle={},d.defaultOptionField={},d.formValidations={},d.formPlaceholder={},d.formElementAttributes={},d.buttonElements={},d.passwordMeterConfiguration=[],d.buttonsName={},d.eventsName={},d.log=function(e){d.options.debugMode&&"undefined"!=typeof console&&console.error(e)},d.customInterface=function(e,o){var t=o.templateName||"";n(function(){f.renderCustomInterface(e,"",t)})},d.clearSession=function(){d.storage.removeBrowserStorage(LoginRadiusDefaults.storedTokenName),d.storage.removeBrowserStorage(LoginRadiusDefaults.storedUidName),d.storage.removeBrowserStorage(LoginRadiusDefaults.storedTwoFAToken)},d.setSessionToken=function(e){var o={session_token:e.session_token,session_expires_in:e.session_expires_in};d.storage.setBrowserStorage(LoginRadiusDefaults.storedSessionTokenData,JSON.stringify(o))},d.getSessionToken=function(){var e=JSON.parse(d.storage.getBrowserStorage(LoginRadiusDefaults.storedSessionTokenData));return e&&e.session_expires_in&&new Date<new Date(e.session_expires_in)?e.session_token:(d.removeSessionToken(),!1)},d.removeSessionToken=function(){d.storage.removeBrowserStorage(LoginRadiusDefaults.storedSessionTokenData)},d.documentCookies=Object.assign({},LRNameSpace.cookies);var y=[];function n(e){d.isApiCallingStarted||""!==d.options?d.isApiCallingStarted&&(""!==d.options?e():"logout"===d.useraction?(d.isApiCallingStarted=!1,n(e)):y.push(e)):(d.isApiCallingStarted=!0,y.push(e),h.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"appInfo?apikey="+m.apiKey,"",function(e){var o,t,n,i,a,r,s,l,u,c;o=e,c={},m.securityQuestionEnabled=o.IsSecurityQuestion,m.appName=m.appName||o.AppName,m.RegistrationFormSchema=o.RegistrationFormSchema,m.loginLockedType=o.LoginLockedConfiguration&&o.LoginLockedConfiguration.LoginLockedType,m.securityQuestionEnabled&&(m.SecurityQuestions=o.SecurityQuestions.Questions,m.securityQuestionsCount=void 0===m.securityQuestionsCount?o.SecurityQuestions.SecurityQuestionCount:m.securityQuestionsCount),void 0===m.passwordLength&&m.displayPasswordStrength&&m.RegistrationFormSchema&&(t=h.findInSchema(m.RegistrationFormSchema,"name","password").rules.split("|"),i=(n=h.isSubstring("min_length[",Object.keys(t).map(function(e){return t[e]})))?t[n].substring(t[n].lastIndexOf("min_length[")+11,t[n].lastIndexOf("]")):"",r=(a=h.isSubstring("max_length[",Object.keys(t).map(function(e){return t[e]})))?t[a].substring(t[a].lastIndexOf("max_length[")+11,t[a].lastIndexOf("]")):"",s={},i&&(s.min=parseInt(i)),r&&(s.max=parseInt(r)),m.passwordLength=s),m.SocialSchema=o.SocialSchema,m.maskSensitiveInput=m.encryptedAnswer||m.maskSensitiveInput,m.noCallbackForSocialLogin=void 0!==m.noCallback?m.noCallback:m.noCallbackForSocialLogin,m.v2RecaptchaSiteKey=m.v2RecaptchaSiteKey||o.V2RecaptchaSiteKey,o.TwoFactorAuthentication.IsEnabled&&(c.optionalTwoFactorAuthentication=!0,c.twoFactorAuthentication=!1,c.googleAuthentication=o.TwoFactorAuthentication.IsGoogleAuthenticator,o.TwoFactorAuthentication.IsRequired&&(c.optionalTwoFactorAuthentication=!1,c.twoFactorAuthentication=!0)),m.otpEmailVerification=void 0===m.otpEmailVerification?o.OTPEmailVerification:m.otpEmailVerification,m.optionalTwoFactorAuthentication=void 0===m.optionalTwoFactorAuthentication?c.optionalTwoFactorAuthentication:m.optionalTwoFactorAuthentication,m.twoFactorAuthentication=void 0===m.twoFactorAuthentication?c.twoFactorAuthentication:m.twoFactorAuthentication,m.googleAuthentication=void 0===m.googleAuthentication?c.googleAuthentication:m.googleAuthentication,m.phoneLogin=void 0===m.phoneLogin?o.IsPhoneLogin:m.phoneLogin,m.passwordlessLoginOTP=void 0===m.instantOTPLogin&&void 0===m.passwordlessLoginOTP?o.IsInstantSignin.SmsOtp:m.instantOTPLogin||m.passwordlessLoginOTP,"optional"===o.EmailVerificationFlow?c.optionalEmailVerification=!0:"disabled"===o.EmailVerificationFlow&&(c.disabledEmailVerification=!0),m.optionalEmailVerification=void 0===m.optionalEmailVerification?c.optionalEmailVerification:m.optionalEmailVerification,m.disabledEmailVerification=void 0===m.disabledEmailVerification?c.disabledEmailVerification:m.disabledEmailVerification,m.loginOnEmailVerification=void 0===m.loginOnEmailVerification?o.IsLoginOnEmailVerification:m.loginOnEmailVerification,m.passwordlessLogin=void 0===m.instantLinkLogin&&void 0===m.passwordlessLogin?o.IsInstantSignin.EmailLink:m.instantLinkLogin||m.passwordlessLogin,m.askRequiredFieldForTraditionalLogin=void 0===m.askRequiredFieldForTraditionalLogin?o.AskRequiredFieldsOnTraditionalLogin:m.askRequiredFieldForTraditionalLogin,m.stayLogin=void 0===m.stayLogin?o.IsRememberMe:m.stayLogin,m.disableSignup=void 0===m.disableSignup?o.IsDisabledRegistration:m.disableSignup,m.riskBasedAuthentication=void 0===m.riskBasedAuthentication?o.IsRiskBasedAuthentication:m.riskBasedAuthentication,m.noCallbackForSocialLogin=void 0===m.noCallbackForSocialLogin?o.IsNoCallbackForSocialLogin:m.noCallbackForSocialLogin,m.usernameLogin=void 0===m.usernameLogin?o.IsUserNameLogin:m.usernameLogin,m.promptPasswordOnSocialLogin=void 0===m.promptPasswordOnSocialLogin?o.AskPasswordOnSocialLogin:m.promptPasswordOnSocialLogin,m.v2Recaptcha=void 0===m.v2Recaptcha?o.IsV2Recaptcha:m.v2Recaptcha,m.invisibleRecaptcha=void 0===m.invisibleRecaptcha?o.IsInvisibleRecaptcha:m.invisibleRecaptcha,m.askOptionalFieldsOnRegistration=void 0===m.askOptionalFieldsOnRegistration?o.AskOptionalFieldsOnSocialSignup:m.askOptionalFieldsOnRegistration,m.askEmailForUnverifiedProfileAlways=void 0===m.askEmailForUnverifiedProfileAlways?o.AskEmailIdForUnverifiedUserLogin:m.askEmailForUnverifiedProfileAlways,m.logoutOnVerifyEmail=void 0===m.logoutOnVerifyEmail?o.IsLogoutOnEmailVerification:m.logoutOnVerifyEmail,m.disableAccountLinking=o.IsDisabledAccountLinking,m.duplicateEmailWithUniqueUsername=o.DuplicateEmailWithUniqueUsername,m.customDomain=m.customDomain||o.CustomDomain,m.optionalRecaptchaConfiguration=o.OptionalRecaptchaConfiguration,m.tencentCaptchaAppid=void 0===m.tencentCaptchaAppid?o.QQTencentCaptchaKey:m.tencentCaptchaAppid,m.privacyPolicyConfiguration=o.PrivacyPolicyConfiguration,m.isConsentManagementEnabled=void 0===m.IsConsentManagementEnabled?o.IsConsentManagementEnabled:m.IsConsentManagementEnabled,c.isPINAuthentication=!1,o.PINAuthentication&&o.PINAuthentication.IsEnabled&&(c.isPINAuthentication=!0,c.PINConfiguration=Object.assign({},o.PINAuthentication.Configuration),m.PINConfiguration?m.PINConfiguration=Object.assign({},c.PINConfiguration,m.PINConfiguration):m.PINConfiguration=Object.assign({},c.PINConfiguration)),m.isPINAuthentication=c.isPINAuthentication,m.isPINAuthentication&&(d.pinSchema=[],l=h.findInSchema(m.RegistrationFormSchema,"name","pin"),h.isEmpty(l)?d.log("Pin schema is not defined"):(d.pinSchema.push(l),!m.PINConfiguration.IsRequired||d.pinSchema[0].rules&&-1!==d.pinSchema[0].rules.indexOf("required")||(d.pinSchema[0].rules=d.pinSchema[0].rules?[d.pinSchema[0].rules,"required"].join("|"):"required"),u=h.findInSchema(m.RegistrationFormSchema,"name","confirmpin"),h.isEmpty(u)||d.pinSchema.push(u))),m.isConsentManagementEnabled&&f.setConsentTemplate(),m=h.mergeOptions(g,m),d.options=m;for(var p=0;p<y.length;p++)y[p]()},"registrationSchema"))}var l=[];d.getConsentConfiguration=function(e){d.isConsentApiCallingStarted||""!==d.consentOptions?d.isConsentApiCallingStarted&&(""!==d.consentOptions?e(d.consentOptions):l.push(e)):(d.isConsentApiCallingStarted=!0,l.push(e),h.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"consent?apiKey="+d.options.apiKey,"",function(e){if(e){d.consentOptions={},d.consentsList={};for(var o="",t=0;t<e.length;t++){for(var n=0;n<e[t].Events.length;n++)o=e[t].Events[n].Name,"true"===e[t].Events[n].IsCustom&&(o="custom_"+o),d.consentOptions[o]={},d.consentOptions[o].ConsentForm=e[t].ConsentForm,d.consentOptions[o].TermOfService=e[t].TermOfService,d.consentOptions[o].PrivacyPolicy=e[t].PrivacyPolicy;for(var i=0;i<e[t].ConsentForm.length;i++)for(var a=e[t].ConsentForm[i],r=0;r<a.Consents.length;r++)d.consentsList[a.Consents[r].ConsentId]||(d.consentsList[a.Consents[r].ConsentId]=a.Consents[r])}for(var s=0;s<l.length;s++)l[s](d.consentOptions)}else d.isConsentApiCallingStarted=!1}))},d.getAppConfiguration=n,d.progressiveProfiling=new LRNameSpace.ProgressiveProfiling(d,f,e,LoginRadiusDefaults),d.progressiveProfiling.init=function(){n(function(){d.progressiveProfiling.fetchSchema(function(e){d.progressiveProfilingSchema=e,d.$hooks.register("registrationSchemaFilter",function(e,o){d.options.progressiveProfilingTraditional&&(d.LoggedinSocialProvderProfile=o)})},"progressiveProfilingSchema")})}}function LoginRadiusHooksModel(w){var p=w.util,t=LoginRadiusDefaults.messages;w.$hooks={hooks:[],register:function(e,o,t){void 0===w.$hooks.hooks[e]&&(w.$hooks.hooks[e]=[]),parseInt(t,10)===t&&w.$hooks.hooks[e].length>t+1?w.$hooks.hooks[e].splice(t,0,o):w.$hooks.hooks[e].push(o)},call:function(e){var o=Array.prototype.splice.call(arguments,1);if(void 0!==w.$hooks.hooks[e])for(var t=0,n=w.$hooks.hooks[e].length;t<n;++t)w.$hooks.hooks[e]&&w.$hooks.hooks[e][t]&&w.$hooks.hooks[e][t].apply(null,o)}},w.$hooks.register("addEventOnElement",function(e){p.extend(w.eventsName,e)}),w.$hooks.register("mapErrorMessages",function(e){if(e.code&&e.message)w.errorMessages.push(e);else if(p.isArray(e))for(var o=0;o<e.length;o++)e[o].code&&e[o].message?w.errorMessages.push(e[o]):w.log(t.notValidMessage);else w.log(t.notValidMessage)}),w.$hooks.register("passwordMeterConfiguration",function(e){p.isArray(e)?p.extend(w.passwordMeterConfiguration,e):w.log(t.passwordStrengthMessage)}),w.$hooks.register("setButtonsName",function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).toLowerCase()]=e[o];p.extend(w.buttonsName,i)}),w.$hooks.register("mapValidationMessages",function(e){if(e.rule&&e.message)w.validationMessages.push(e);else if(p.isArray(e))for(var o=0;o<e.length;o++)e[o].rule&&e[o].message?w.validationMessages.push(e[o]):w.log(t.notValidMessage);else w.log(t.notValidMessage)}),w.$hooks.register("customizeFormLabel",function(e){p.extend(w.formCustomLabel,e)}),w.$hooks.register("customizeElementTitle",function(e){p.extend(w.formElementsTitle,e)}),w.$hooks.register("defaultChoiceOption",function(e){p.extend(w.defaultOptionField,e)}),w.$hooks.register("customizeFormPlaceholder",function(e){p.extend(w.formPlaceholder,e)}),w.$hooks.register("formValidationRules",function(e){p.extend(w.formValidations,e)}),w.$hooks.register("formAttributes",function(e){p.extend(w.formElementAttributes,e)}),w.$hooks.register("buttonAttributes",function(e){p.extend(w.buttonElements,e)}),w.$hooks.register("addFormCaptcha",function(i,a,r){w.getAppConfiguration(function(){r&&(w.options[r]=!0);var e=i+"recaptcha_widget";p.addRecaptchaJS();var o=[];p.captchaSchema(e,o,!1,a);var t,n=document.createElement("div");n.setAttribute("name",o[0].name),w.options.invisibleRecaptcha&&(t=a.toString(),t=/function ([^\(]*)/.exec(t)[1],o[0].html=o[0].html.replace("onCaptchaSubmit",t)),n.innerHTML=o[0].html,p.addHTMLContent(i,n,!0),p.renderV2Recaptcha(e,!1,a)})}),w.$hooks.register("addFormCaptchaExecute",function(e){var o,t=e+"recaptcha_widget",n=p.elementById(t+"_tencent");w.options.invisibleRecaptcha?o=setInterval(function(){if("undefined"!=typeof grecaptcha){try{grecaptcha.execute(window[t])}catch(e){}clearInterval(o)}},1e3):n&&"none"!==n.style.display&&(w.options.tencentCaptcha||w.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&n.click()}),w.$hooks.register("successCallback",function(o,t,e){var n,i,a,r,s,l,u,c="";o&&(w.$hooks.register("setCurrentAction",function(){w.storage.setBrowserStorage("LRSetSafariToken",o)}),c="verifyotp"===o.toLowerCase()?"otp":o.toLowerCase()),"1132"==t.ErrorCode?(w.options.v2Recaptcha||w.options.invisibleRecaptcha||w.options.tencentCaptcha||w.options.tencentCaptchaAsFallback||(w.options.v2Recaptcha=!0),"verifyemail"===c&&(p.elementById("loginradius-submit-verify").style.display="block"),n=w.LRPrefix.replace("##","")+"recaptcha_widget_"+c,l=n,(u=w.util.elementById(l,!0))&&(u.style.display="block"),window.grecaptcha&&u&&""!==u.innerHTML?grecaptcha.reset(window[l+"lr_recaptcha_widgets_idprefix"]):w.util.renderV2Recaptcha(l,!1)):"1148"==t.ErrorCode||"1165"==t.ErrorCode?(i=p.parseString(e))&&!i.hasOwnProperty("securityanswer")&&(a=e,r=c,w.options.securityQuestionEnabled&&(s=p.jsonToQueryString(JSON.parse(a)),new LoginRadiusControllers(w).getSecurityQuestionsController(s,function(i){if(0<i.length)for(var e=0;e<i.length;e++)-1!==s.indexOf(i[e].name)&&i.splice(e,1);var o,t,n;0<i.length&&(o=document.createElement("div"),t=[],n=w.LRPrefix.split("##"),new SetLoginRadiusCommonFunctions(w).createFormFields(i,o,r,t,n[0],n[1]),new FormValidator(n[1]+r,t,function(e){w.mergeFormErrors={},w.mergeFormErrors=e}),w.$hooks.register("startProcess",function(e,o){for(var t={},n=0;n<i.length;n++)o&&o[i[n].name]&&(t[i[n].name]=o[i[n].name],delete o[i[n].name]);o&&(o.securityanswer=t)}),w.util.addHTMLContent("",o,!0,r,n[0]))}))):"1194"==t.ErrorCode?function(o,e){var t="",n=w.privacyPolicySchema.slice();n[0].rules="Strict"===w.options.privacyPolicyConfiguration.Mode?"required":"";var i=new SetLoginRadiusCommonFunctions(w),a=new LoginRadiusControllers(w,i);w.$hooks.call("getCurrentActionOptions",e);var r=function(){},s=function(){},l="";w.currentActionOptions[e]&&(r=w.currentActionOptions[e].onSuccess||r,s=w.currentActionOptions[e].onError||s,l=w.currentActionOptions[e].classPrefix||l);"socialLogin"===e?(t=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),w.$hooks.call("socialLoginFormRender")):t=o.Data.access_token;i.createForm(n,"privacyPolicyUpdate",w.currentLRContainer,function(e){a.updatePrivacyPolicy(t,o,r,s,null,w.currentLRContainer,l)},function(e){s(i.setMappedMessage(e))})}(t,o):"1243"==t.ErrorCode?function(e,o){{var t,n,i,a,r,s;w.pinSchema&&w.pinSchema.length?(t=e.Data.PINAuthToken,(n=new SetLoginRadiusCommonFunctions(w)).setPINRule(p.findInSchema(w.pinSchema,"name","confirmpin")),i=new LoginRadiusControllers(w,n),w.$hooks.call("getCurrentActionOptions",o),a=function(){},r=function(){},s="",w.currentActionOptions[o]&&(a=w.currentActionOptions[o].onSuccess||a,r=w.currentActionOptions[o].onError||r,s=w.currentActionOptions[o].classPrefix||s),n.createForm(w.pinSchema,"pinSetup",w.currentLRContainer,function(e){i.configurePINController(t,e,a,r,w.currentLRContainer,s)},function(e){r(n.setMappedMessage(e))})):w.log("Pin Schema is not defined in the schema")}}(t,o):1226===t.ErrorCode&&t.Data&&t.Data.ConsentToken&&!w.lrApiFramework&&w.getConsentConfiguration(function(e){!function(e,l,o){var t,u=e.Data.ConsentToken;e.Data.ConsentProfile&&e.Data.ConsentProfile.Consents&&e.Data.ConsentProfile.Consents.Options&&(t=e.Data.ConsentProfile.Consents.Options);for(var c=new SetLoginRadiusCommonFunctions(w),p=new LoginRadiusControllers(w,c),d="",m=[],g=[],n=0;n<e.Data.Events.length;n++)m.push(e.Data.Events[n].Name);w.$hooks.call("getCurrentActionOptions",l);var f=function(){},h=function(){},y="",v="";w.currentActionOptions[l]&&(f=w.currentActionOptions[l].onSuccess||f,h=w.currentActionOptions[l].onError||h,y=w.currentActionOptions[l].classPrefix||y,v=w.currentActionOptions[l].container||"");v=v||w.currentLRContainer;var C=function(r,s){var e=[],o=c.createConsentInterface(r[s],t);""!==o&&(e.push({html:o,type:"html",name:"consent"}),c.createForm(e,"consentlogin",v,function(e){var o=c.consentValidation(e,s);if(0<o.length)h(c.setMappedMessage(o));else if(d=d?d+"&"+e:e,g.push({Event:s,IsCustom:!1}),m.splice(0,1),0<m.length)C(r,m[0]);else{var t,n=w.util.parseQueryString(d),i=[];for(t in n){var a=t.replace("consent_","");i.push({ConsentOptionId:a,IsAccepted:n[t]})}n={},0<i.length&&(n.Events=g,n.Data=i),p.submitConsentController(u,n,f,h,v,y,l)}},function(e){h(c.setMappedMessage(e))}))};"socialLogin"===l&&w.$hooks.call("socialLoginFormRender");C(o,m[0])}(t,o,e)})}),w.$hooks.register("afterFormRender",function(e,o,t,n){var i=w.options.RegistrationFormSchema,a=[];if("registration"===e){for(var r,s,l={},u=0;u<i.length;u++)i[u]&&i[u].DataSource&&null!==i[u].DataSource&&(l[i[u].DataSource]=i[u],l[i[u].DataSource].children=[]);for(s in l)l.hasOwnProperty(s)&&((r=l[s]).ParentDataSource&&null!=r.ParentDataSource?l[r.ParentDataSource].children.push(r):a.push(r));0<a.length&&function(r,e,s){for(var l=[],u=new SetLoginRadiusCommonFunctions(w),o=0;o<e.length;o++)e[o].ParentDataSource||p.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[o].DataSource+"?apiKey="+w.options.apiKey,"",function(e,o){if(l[e.DataSource]=o,l[e.DataSource])for(var t=0;t<l[e.DataSource].length;t++){var n=document.createElement("option");n.setAttribute("value",l[e.DataSource][t].Id),n.appendChild(document.createTextNode(l[e.DataSource][t].Key));var i=document.getElementById(s+"registration-"+e.name);i&&i.appendChild(n)}if(e&&e.children&&0<e.children.length)for(var a=0;a<e.children.length;a++)u.addChangeEventHandler(r,e,e.children[a],s)},"registration",e[o])}(o,a,t)}"validatecode"===e&&function(i,e,a){for(var o=0;o<e.length;o++)e[o].DataSource&&w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[o].DataSource+"?apiKey="+w.options.apiKey,"",function(e,o){for(var t=0;t<o.length;t++){var n=document.createElement("option");n.setAttribute("value",o[t].Id),n.appendChild(document.createTextNode(o[t].Key)),document.getElementById(a+i+"-"+e.name).appendChild(n)}},"registration",e[o])}(e,i,t)}),w.$hooks.register("setLocaleBasedInfo",function(e){for(var o in e)if(e.hasOwnProperty(o))switch(o){case"labels":p.extend(w.formCustomLabel,e[o]);break;case"placeholders":p.extend(w.formPlaceholder,e[o]);break;case"validationMessages":w.$hooks.call("mapValidationMessages",e[o]);break;case"errorMessages":w.$hooks.call("mapErrorMessages",e[o]);break;case"passwordMeterConfiguration":w.$hooks.call("passwordMeterConfiguration",e[o]);break;case"buttonsName":w.$hooks.call("setButtonsName",e[o])}})}function SetLoginRadiusCommonFunctions(O){var D=this,A=LoginRadiusDefaults.messages,C=LoginRadiusDefaults.buttonNames,I=new LoginRadiusControllers(O,D);function F(){var n={0:"worst",1:"bad",2:"weak",3:"good",4:"strong",5:"secure"},i={0:"#dd514c",1:"orange",2:"yellow",3:"#5eb95e",4:"blue",5:"violet"},a={0:"Worst",1:"Bad",2:"Weak",3:"Good",4:"Strong",5:"Secure"};return function(){var e,o=[],t=O.passwordMeterConfiguration;for(e in n)t[e]&&t[e].case?t[e].case.toLowerCase()===n[e]&&o.push({color:t[e].color?t[e].color:i[e],Message:t[e].message?t[e].message:a[e]}):o.push({color:i[e],Message:a[e]});return o}()}function w(t,n,e,o){var i=O.util.elementById(e+"_tencent"),a=!1;"profileeditor"===o&&(a=!0);var r=O.util.elementById(e);window.grecaptcha&&O.options.invisibleRecaptcha&&r&&""!==r.innerHTML&&"none"!==r.style.display?grecaptcha.execute(window[e+"lr_recaptcha_widgets_idprefix"]):i&&"none"!==i.style.display&&(O.options.tencentCaptcha||O.options.tencentCaptchaAsFallback&&!window.grecaptcha)?window.onTencentCaptchaSubmitCallback=function(e){var o=O.util.serialize(t,a);o+="&qq_captcha_ticket="+e.ticket,o+="&qq_captcha_randstr="+e.randstr,n(o)}:n(O.util.serialize(t,a))}function T(e,o,t,n,i){var a="linksignin";"passwordlessLoginOTPButtonLabel"===e&&(a="otpsignin");var r=document.createElement("input");r.type="submit";var s=O.buttonsName[e.toLowerCase()]||C[e.toLowerCase()],l=C[e.toLowerCase()];r.value=s,r.id=n+a+"-"+l.toLowerCase().replace(/ /g,"-"),r.setAttribute("class",i+a+" "+a+"-"+n+l.toLowerCase().replace(/ /g,"-")),O.options.disableButtonOnsubmit&&(O.$hooks.register("startProcess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!0)}),O.$hooks.register("xhrEndWithError",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!1)}),O.$hooks.register("xhrEndWithSuccess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&O.options.enableSubmitOnSuccess&&(r.disabled=!1)})),o.appendChild(r),O.util.addEvent("click",t,function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1}),"passwordlessLoginOTPButtonLabel"===e?O.util.addEvent("click",r,function(e){window.lrpasswordlessloginotp=!0,window.lrpasswordlesslogin=!1}):O.util.addEvent("click",r,function(e){window.lrpasswordlesslogin=!0,window.lrpasswordlessloginotp=!1})}D.renderCustomInterface=function(e,L,P,R,b,o){O.options.selector=e;function t(e){var o,t=e;O.options.providerCountry&&!O.options.providersList&&(t=function(e,o){for(var t=[{Name:"Facebook",country:"global",except:"china"},{Name:"Google",country:"global",except:"china"},{Name:"Yahoo",country:"global",except:"china"},{Name:"Live",country:"global",except:"china"},{Name:"Twitter",country:"global",except:"china"},{Name:"Linkedin",country:"global",except:"china"},{Name:"Myspace",country:"US"},{Name:"Foursquare",country:"global",except:"china"},{Name:"Vkontakte",country:"Russia"},{Name:"Renren",country:"China"},{Name:"QQ",country:"China"},{Name:"Kaixin",country:"China"},{Name:"Github",country:"global",except:"china"},{Name:"Mailru",country:"Russia"},{Name:"Amazon",country:"US"},{Name:"Paypal",country:"global"},{Name:"Salesforce",country:"global"},{Name:"ODNOKLASSNIKI",country:"Russia"},{Name:"WORDPRESS",country:"global"},{Name:"GOOGLEPLUS",country:"global",except:"china"},{Name:"Disqus",country:"global",except:"china"},{Name:"INSTAGRAM",country:"global",except:"china"},{Name:"SINAWEIBO",country:"China"},{Name:"XING",country:"Germany"},{Name:"PINTEREST",country:"global",except:"china"},{Name:"LINE",country:"global"},{Name:"AOL",country:"US"}],n=0;n<t.length;n++)for(var i=0;i<o.length;i++)if(o[i]&&o[i].Name.toLowerCase()===t[n].Name.toLowerCase()){if(t[n].country.toLowerCase()===e.toLowerCase()||"global"===t[n].country.toLowerCase()&&!t[n].except||t[n].except&&t[n].except.toLowerCase()!==e.toLowerCase())continue;o.splice(i,1)}return o}(O.options.providerCountry,t)),O.$hooks.call("socialInterfaceProviders",t),O.options.providersList&&(o=O.options.providersList);var n=O.options.hashTemplate?O.util.hashTmpl:O.util.tmpl,i=P.split(","),a=O.util.getQueryParameterByName("scope");""===O.options.scope&&a&&(O.options.scope=a);var r="&callback="+O.options.callbackUrl+"&same_window="+O.options.callbackInsideSameWindow+"&is_access_token="+O.options.accessTokenResponse+"&callbacktype="+O.options.callbackType+"&disablesignup="+O.options.disableSignup;-1===r.indexOf("scope")&&(r+="&scope="+O.options.scope),O.options.isMobile&&(r+="&ismobile=true"),b&&(r+="&ac_linking=true"),O.options.isCustomScope&&(r+="&is_custom_scope=true");for(var s=O.util.getThisObjectName(),l=0;l<i.length;l++){var u=O.util.elementById(i[l]);u&&-1!==u.innerHTML.indexOf("ac_linking")&&(r=r.replace("&ac_linking=true",""));var c=[];E[l]="";for(var p=0;p<t.length;p++){t[p].ObjectName=s,-1===t[p].Endpoint.indexOf("callback=")&&(t[p].Endpoint+=r);var d={islinked:!1,providerId:!1};L&&L[t[p].Name.toLowerCase()]&&(d.islinked=!0,d.providerId=L[t[p].Name.toLowerCase()]),t[p].isLinked=d.islinked,t[p].providerId=d.providerId;var m=t[p];c.push(m)}for(var g=[],f=0;f<c.length;f++)c[f].isLinked&&g.push(c[f]);if(0<g.length){for(var h=0;h<c.length;h++)c[h].isLinked||g.push(c[h]);c=g}for(var y=0;y<c.length;y++)""!==i[l]&&(void 0!==o&&-1===o.indexOf(c[y].Name)&&-1===o.indexOf(c[y].Name.toLowerCase())||(E[l]+=n(i[l],c[y])))}for(var v=O.options.selector.split(","),C=0;C<v.length;C++){var w,T=v[C];if(0===T.indexOf(".")){T=T.replace(".","");var S=O.util.elementsByClass(T);if(S&&0<S.length)for(var k=0;k<S.length;k++)R?S[k].innerHTML+=E[C]:S[k].innerHTML=E[C]}else{""===T||(w=O.util.elementById(T))&&(R?w.innerHTML+=E[C]:w.innerHTML=E[C])}}}var E=[];o?t(o):void 0!==O.options.SocialSchema&&t(O.options.SocialSchema.Providers)},D.mapRegistrationSchema=function(e,o,t){var n,i,a,r,s=O.util.parseQueryString(o),l={},u={},c={},p=[],d=[];for(n in s){if(-1!==n.indexOf("cf_"))l[n.replace("cf_","")]=s[n],delete s[n];else if(-1!==n.indexOf("consent_")){var m={ConsentOptionId:n.replace("consent_",""),IsAccepted:s[n]};d.push(m),delete s[n]}else if("emailsubscription"===n)s.IsEmailSubscribed=!("on"!==s[n]&&"true"!==s[n]),delete s[n];else if("emailid"===n||"email"===n)u.value=s[n],u.type="Primary";else if("SecurityQuestionAnswer"!==n&&-1!==n.indexOf("securityQuestion")){for(var g={},f=0;f<O.options.securityQuestionsCount;f++)s["securityAnswer"+f]&&s["securityQuestion"+f]&&(g[s["securityQuestion"+f]]=s["securityAnswer"+f]),delete s["securityQuestion"+f],delete s["securityAnswer"+f];0!==Object.keys(g).length&&(s.SecurityQuestionAnswer=g)}else{"country"===n?c=-1!==s[n].indexOf("|")?{code:s[n].split("|")[0],name:s[n].split("|")[1]}:{code:"",name:s[n]}:(i=O.util.findInSchema(e,"name",n))&&i.Parent&&(a=-1!==n.indexOf("_")?n.split("_")[1]:n,void 0===s[i.Parent]?(s[i.Parent]=[],(r={})[a]=s[n],"Addresses"===i.Parent?r.type="personal":"PhoneNumbers"!==i.Parent||r.phonetype||(r.phonetype="default"),s[i.Parent].push(r)):("Addresses"!==i.Parent||s[i.Parent][0].type||(s[i.Parent][0].type="personal"),s[i.Parent][0][a]=s[n]),delete s[n])}}return 0!==Object.keys(l).length&&(s.CustomFields=l),0!==Object.keys(u).length&&(p.push(u),s.email=p),0!==Object.keys(c).length&&(s.country=c),O.options.isPINAuthentication&&O.options.PINConfiguration.AskOnRegistration&&(s=D.sanitizePinData(s)),0<d.length&&(s.Consents={Events:[{Event:"Register",IsCustom:!1}],Data:d}),s};var r=!(D.showQRCode=function(e,o,t,n,i,a,r){var s=O.QRCodeSchema.slice();O.options.maskSensitiveInput?s[0].type="password":s[0].type="string";function l(e,o){var t;e&&s.splice(0,0,{type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:e}),o&&(t=i||LoginRadiusDefaults.classPrefix,s.splice(1,0,{type:"button",name:"ManualEntryCode",display:"Get Manual Entry Code",rules:"",permission:"r",title:"Use this code when you unable to scan QR code. Tap 'Enter a provided key' then enter the email address of your Account and enter this key in your authenticator app",event:"click",eventCallback:function(e){document.getElementsByClassName("content-"+t+"ManualEntryCode")[0].innerHTML=o}}))}var u,c,p,d=!0;e.SecondFactorAuthentication?(c=e.SecondFactorAuthentication.QRCode,p=e.SecondFactorAuthentication.ManualEntryCode,e.SecondFactorAuthentication.IsGoogleAuthenticatorVerified||l(c,p)):(d=!1,c=e.QRCode,p=e.ManualEntryCode,e.IsGoogleAuthenticatorVerified?("false"!==O.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)&&O.options.twoFactorAuthentication||O.options.optionalTwoFactorAuthentication)&&(u=O.util.getButtonAttribute("disablegoogleauthenticator",i),O.util.addHTMLContent(o,u),O.util.addEvent("click",u,function(e){var o;O.options.twoFactorAuthentication?(o=O.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),"false"!==O.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)&&"false"!==o?I.resetTwoFactorAuthenticationController("googleauthenticator",function(e,o){O.storage.setBrowserStorage(LoginRadiusDefaults.storedGAAuth,!1),t(e,o)},n):n("false"===o?[{Message:"Google authenticator has already disabled."}]:[{Message:"TwoFactorAuthentication has required, So atleast one authenticator should be required."}])):I.resetTwoFactorAuthenticationController("googleauthenticator",t,n)})):(d=!0,l(c,p))),d&&D.createForm(s,"showQRcode",o,function(e){I.verify2FAOTPController(e,t,n,a,r)},function(e){n(e)},i)});function S(e,o){var t=e.toLowerCase();return"changepassword"===t&&o.PutChangePassword||("profileeditor"===t||"loginRequiredFieldsUpdate"===t||"progressiveProfiling"===t||"socialRegistration"===t)&&o.PutUpdateProfile||"forgotpassword"===t&&(O.options.phoneLogin&&o.PostForgotPasswordByPhone&&o.PostForgotPasswordByEmail||!O.options.phoneLogin&&o.PostForgotPasswordByEmail)||"login"===t&&(O.options.usernameLogin&&o.PostLoginByUserNameAndPassword&&O.options.phoneLogin&&o.PostLoginByEmailAndPassword&&o.PostLoginByPhoneAndPassword||O.options.phoneLogin&&o.PostLoginByEmailAndPassword&&o.PostLoginByPhoneAndPassword||!O.options.phoneLogin&&O.options.usernameLogin&&o.PostLoginByUserNameAndPassword||!O.options.usernameLogin&&!O.options.phoneLogin&&o.PostLoginByEmailAndPassword)}D.socialLogin=function(t,n,i,a){window.html5passToken=function(e){var o;r||(r=!0,t=LoginRadiusDefaults.socialRegFormId||t,(o=O.storage.getBrowserStorage("LRSetSafariToken"))&&(O.$hooks.call("getCurrentActionOptions",o),n=window.LRSafarionSuccess||n,i=window.LRSafarionError||i),I.socialLoginReceiveToken(e,t,n,i,a))};var e=O.util.getHashParam("lr-token");e&&window.html5passToken(e),O.loginRadiusHtml5PassToken=window.html5passToken,O.options.isMobile||O.options.noCallbackForSocialLogin?O.$hooks.register("socialCalls",function(e,o){O.options.noCallbackForSocialLogin&&D.pingForSmartLogin(o,function(e){e.access_token?I.socialLoginReceiveToken(e.access_token,t,n,i,a):n(e)},function(){})}):O.util.addEvent("message",window,function(e){-1===e.origin.indexOf(O.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||(t=LoginRadiusDefaults.socialRegFormId||t,"string"==typeof e.data&&LoginRadiusDefaults._uuidFormat.test(e.data)&&I.socialLoginReceiveToken(e.data,t,n,i,a))})},D.resetPassword=function(o,t,n,i,a){var e,r,s,l,u,c,p,d=O.resetPasswordFormSchema.slice();null==O.util.getHashParam("vtype")?(d=O.resetPasswordByPhoneSchema.slice(),D.setPasswordRule(O.util.findInSchema(d,"name","password")),a?(a.email?(e="email",r=a.email):a.username&&(e="username",r=a.username),d.push({type:"hidden",name:e,value:r})):O.options.phoneLogin&&(l="&"+LoginRadiusDefaults.LRPhoneNo,O.util.findInSchema(d,"name","resendotp")||(s=Object.assign({},O.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){O.options.disableResendOTPButton&&O.util.disableResendOTPButton(e),I.forgotPasswordbyPhoneController(LoginRadiusDefaults.LRPhoneNo,o,t,n,i,function(){})}}),d.push(s)))):(D.setPasswordRule(O.util.findInSchema(d,"name","password")),D.setPasswordRule(O.util.findInSchema(d,"name","confirmpassword")),(u=O.util.getHashParam("vtoken"))?O.options.verifyEmailByOTP?(c=O.util.getQueryParameterByName("email"),p="&otp="+u,p+="&email="+encodeURIComponent(c.replace(/ /g,"+")),d.splice(2,1)):O.resetPasswordFormSchema[2].value=u:n([{Message:"Verification Token not found in query string."}])),D.createForm(d,"resetpassword",o,function(e){-1===e.indexOf("otp")||a?(p&&(e+=p),I.resetPasswordController(e,t,n,o,i)):I.resetPasswordByPhoneController(e+l,t,n,o,i)},function(e){n(e)},i)},D.resetPIN=function(o,t,n,i,a){var e,r,s,l,u,c,p,d=O.resetPINFormSchema.slice();null==O.util.getHashParam("vtype")?(d=O.resetPINByPhoneSchema.slice(),D.setPINRule(O.util.findInSchema(d,"name","pin")),a?(a.email?(e="email",r=a.email):a.username&&(e="username",r=a.username),d.push({type:"hidden",name:e,value:r})):O.options.phoneLogin&&(l="&"+LoginRadiusDefaults.LRPhoneNo,O.util.findInSchema(d,"name","resendotp")||(s=Object.assign({},O.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){O.options.disableResendOTPButton&&O.util.disableResendOTPButton(e),I.forgotPINbyPhoneController(LoginRadiusDefaults.LRPhoneNo,o,t,n,i,function(){})}}),d.push(s)))):(D.setPINRule(O.util.findInSchema(d,"name","pin")),D.setPINRule(O.util.findInSchema(d,"name","confirmpin")),(u=O.util.getHashParam("vtoken"))?O.options.verifyEmailByOTP?(c=O.util.getQueryParameterByName("email"),p="&otp="+u,p+="&email="+encodeURIComponent(c.replace(/ /g,"+")),d.splice(2,1)):O.resetPINFormSchema[2].value=u:n([{Message:"Verification Token not found in query string."}])),D.createForm(d,"resetpin",o,function(e){-1===e.indexOf("otp")||a?(p&&(e+=p),I.resetPINController(e,t,n,o,i)):I.resetPINByPhoneController(e+l,t,n,o,i)},function(e){n(e)},i)},D.setPasswordRule=function(e,o){O.options.passwordLength=O.options.passwordlength||O.options.passwordLength;var t,n,i=O.util.findInSchema(O.options.RegistrationFormSchema,"name","password").rules;e&&e.rules&&((t=new RegExp(/matches\[\w*\]/).exec(e.rules))?(n=t[0],e.rules=[i,n].join("|")):e.rules=i,O.options.passwordLength&&O.options.passwordLength.min&&O.options.passwordLength.max&&(e.rules=e.rules||"",e.rules=e.rules.replace("min_length[6]","min_length["+O.options.passwordLength.min+"]").replace("max_length[32]","max_length["+O.options.passwordLength.max+"]"))),(o=o||!1)&&e&&(e.rules="required")},D.setPINRule=function(e){var o,t,n;O.pinSchema&&O.pinSchema.length&&(o=O.pinSchema[0].rules,e&&e.rules&&((t=new RegExp(/matches\[\w*\]/).exec(e.rules))?(n=t[0],e.rules=[o,n].join("|")):e.rules=o,O.options.PINConfiguration.IsRequired&&-1===e.rules.indexOf("required")&&(e.rules=e.rules?[e.rules,"required"].join("|"):"required")))},D.changeNumberForm=function(o,e,t,n,i,a,r,s){var l=O.util.getButtonAttribute("changenumber",i),u=O.util.getButtonAttribute("disableotpauthenticator",i),c=O.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),p=O.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e?(e.appendChild(l),p&&!O.LRCheckLogin&&(O.options.optionalTwoFactorAuthentication||"false"!==c&&O.options.twoFactorAuthentication)&&e.appendChild(u)):(O.util.addHTMLContent(o,l,a),p&&!O.LRCheckLogin&&(O.options.optionalTwoFactorAuthentication||"false"!==c&&O.options.twoFactorAuthentication)&&O.util.addHTMLContent(o,u,!0)),O.util.addEvent("click",u,function(e){var o;O.options.twoFactorAuthentication?(o=O.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth),"false"!==O.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth)&&"false"!==o?I.resetTwoFactorAuthenticationController("otpauthenticator",function(e,o){O.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,!1),t(e,o)},n):n("false"===o?[{Message:"OTP authenticator has already disabled."}]:[{Message:"TwoFactorAuthentication is required, So atleast one authenticator should be required."}])):I.resetTwoFactorAuthenticationController("otpauthenticator",t,n)}),O.util.addEvent("click",l,function(e){document.getElementsByName(i+"changePhone")[0]||D.updatePhoneNumber(o,t,n,i,"changePhone",r,s)})},D.validateAndCall=function(e){LoginRadiusDefaults.isSSOInitFired?O.options.appName?e():O.log("LoginRadius site name (app name) required to do SSO"):O.log("Init method should be called first then login.")},D.logout=function(n){D.validateAndCall(function(){var e=O.options.tokenExpire?"?tokenExpire=1":"",o=O.options.tokenExpire?"tokenExpire":"logout",t=O.options.customDomain||O.options.appName+"."+LoginRadiusDefaults.hubDomain;O.util.ajaxCall("get","https://"+t+"/ssologin/"+o+e,"",function(e){LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,O.options.appPath),O.clearSession(),n&&n()})})},D.otpEmailVerification=function(t,n,i,a,r){var e=O.otpSchema;D.createForm(e,"otp",t,function(e){var o="",o="string"!=typeof r?(e=O.util.parseQueryString(e),O.util.mergeOptions(r,e)):r+"&"+e;I.emailVerificationController(o,n,i,t,a,!0)},function(e){i(e)},a)},D.loginHandleToken=function(e,o,t,n,i,a){var r,s,l,u,c,p,d,m,g,f,h,y,v,C,w,T,S,k,L,P,R,b,E;LoginRadiusDefaults.lrResponseCounter=0,LoginRadiusDefaults.lrCounterJwtResponse="",LoginRadiusDefaults.lrCounterTokenResponse="",e&&(e.ErrorCode?n(D.loginRadiusErrorTojsError(e)):(e.Data&&e.Data.hasOwnProperty("Profile")&&(delete(e=e.Data).Data,delete e.IsPosted),O.options.privacyPolicyConfiguration.IsEnabled&&e.Profile&&(r=!1,e.Profile.PrivacyPolicy&&e.Profile.PrivacyPolicy.Version&&(r=D.checkForLatestPrivacyPolicy(e.Profile)),e.Profile=Object.assign({},e.Profile,{IsLatestPrivacyPolicy:r})),s=function(){O.LoginRadiusHostedPage&&LRNameSpace.cookies.setItem("lr-session-token",e.access_token),LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse=e,O.options.tokenType&&"jwt"===O.options.tokenType.toLowerCase()?2===LoginRadiusDefaults.lrResponseCounter&&LoginRadiusDefaults.lrCounterJwtResponse&&LoginRadiusDefaults.lrCounterJwtResponse.signature&&(e.jwttoken=LoginRadiusDefaults.lrCounterJwtResponse.signature,null!=o&&""!==o?t(e,O.util.parseQueryString(o)):t(e)):null!=o&&""!==o?t(e,O.util.parseQueryString(o)):t(e)},l=O.storage.getBrowserStorage("LRSetSafariToken"),O.storage.removeBrowserStorage("LRSetSafariToken"),O.setHostedToken||l?t(e):(u=O.registrationFormSchema&&0<O.registrationFormSchema.length?O.registrationFormSchema:O.options.RegistrationFormSchema,p=(c=O.util.findInSchema(u,"name","phoneid"))&&-1!==c.rules.indexOf("required")&&O.options.phoneLogin,d=e.Profile||e.Data,m=!(O.options.disabledEmailVerification||O.options.optionalEmailVerification),d&&!d.EmailVerified&&m&&!a?n([D.setMappedMessage(A.emailNotVerified)]):p&&d&&!d.PhoneIdVerified&&!a?d.PhoneId?(g={phone:d.PhoneId},f=O.currentLRContainer,h=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp",I.resendOTPController(g,function(){D.verifyOTP("phone="+d.PhoneId,f,t,n,i),D.resendOTP("phone="+d.PhoneId+"&noPhoneVerified=false",f,t,n,i)},n,h,f,i)):O.log("Phone ID is required field."):(d&&d.Uid&&O.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,d.Uid),O.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,e.access_token),O.options.isPINAuthentication&&O.options.PINConfiguration.PINLogin&&e&&e.session_token&&O.setSessionToken(e),LoginRadiusDefaults.isSSOInitFired&&e.access_token?(D.setToken(e.access_token),v=!!(-1===(y=navigator.userAgent.toLowerCase()).indexOf("crios")&&-1===y.indexOf("chrome")&&0<=y.indexOf("safari")),C=/ipad|iphone|ipod/.test(y)&&!window.MSStream,w=0<=y.indexOf("ucbrowser"),T=/crios/i.test(y),S=O.options.customDomain||O.options.appName+"."+LoginRadiusDefaults.hubDomain,k=O.util.getQueryParameterByName("vtype"),L=O.util.getQueryParameterByName("vtoken"),P=window.location.href,k&&(P=P.replace("?vtype="+k,"").replace("&vtype="+k,"")),L&&(P=P.replace("&vtoken="+L,"").replace("?vtoken="+L,"")),P=encodeURIComponent(P),v||C&&w||C&&T?(O.options.askRequiredFieldForTraditionalLogin||O.storage.setBrowserStorage("LRTraditionalLogin",!0),O.$hooks.call("setCurrentAction"),O.options.stayLogin?(R=O.storage.getBrowserStorage("lr-rememberme"),O.storage.removeBrowserStorage("lr-rememberme"),window.location="https://"+S+"/ssologin/setCustomSafariToken?token="+e.access_token+"&apiKey="+O.options.apiKey+"&isrememberMe="+R+"&callback="+P):window.location="https://"+S+"/ssologin/setSafariToken?token="+e.access_token+"&apiKey="+O.options.apiKey+"&callback="+P):(b="",E="setToken",O.options.stayLogin&&(b="&isrememberMe="+O.storage.getBrowserStorage("lr-rememberme"),O.storage.removeBrowserStorage("lr-rememberme"),E="setCustomToken"),O.util.ajaxCall("get","https://"+S+"/ssologin/"+E+"?access_token="+e.access_token+"&apiKey="+O.options.apiKey+b,"",function(){s()},"setToken"))):s(),O.options.tokenType&&"jwt"===O.options.tokenType.toLowerCase()&&D.getJwtToken(e.access_token,t,n)))))},D.getJwtToken=function(e,o,t){O.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/jwt/api/token?apikey="+O.options.apiKey+"&jwtapp="+O.options.integrationName+"&access_token="+e,"",function(e){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterJwtResponse=e,2===LoginRadiusDefaults.lrResponseCounter&&(e.ErrorCode?t(e):(LoginRadiusDefaults.lrCounterTokenResponse.jwttoken=e.signature,o(LoginRadiusDefaults.lrCounterTokenResponse)))},"JWTToken")},D.mapSchema=function(o,e,t,n){e=O.util.keysToLowerCase(e);var i=[];Object.keys(o).forEach(function(e){i.push(o[e])});for(var a=0;a<o.length;a++)if(null!=o[a])if("emailid"===o[a].name.toLowerCase()&&e.email&&e.email[0]&&e.email[0].value&&""!==e.email[0].value){if(e.emailverified||(O.options.disabledEmailVerification||O.options.optionalEmailVerification)&&!O.options.askEmailForUnverifiedProfileAlways){i[a].value=e.email[0].value,o[a]=null;continue}if(!O.options.askEmailForUnverifiedProfileAlways||O.setHostedToken){i[a]=o[a]=null;continue}}else if("country"===o[a].name.toLowerCase()&&""===o[a].Parent&&e.country&&null!=e.country.name&&""!==e.country.name&&"unknown"!==e.country.name.toLowerCase())i[a].value=e.country.name,e.country.code&&(i[a].value=e.country.code+"|"+i[a].value),o[a]=null;else if("emailsubscription"===o[a].name.toLowerCase()&&e.isemailsubscribed&&""!==e.isemailsubscribed)i[a].value=e.isemailsubscribed,o[a]=null;else if("phoneid"===o[a].name.toLowerCase()&&e.phoneid&&""!==e.phoneid)i[a].value=e.phoneid.replace("+",""),o[a]=null;else if("birthdate"===o[a].name.toLowerCase()&&e.birthdate&&""!==e.birthdate){var r=e.birthdate.replace("-","/").replace("-","/").split("/");if(r[2]&&""!==r[2]){i[a].value=e.birthdate,o[a]=null;continue}}else if("password"===o[a].name.toLowerCase()||"confirmpassword"===o[a].name.toLowerCase()){if(null!=e.password||!O.options.promptPasswordOnSocialLogin&&!O.options.promptPasswordOnFirstLoginForSocial){i[a]=o[a]=null;continue}}else if("pin"===o[a].name.toLowerCase()||"confirmpin"===o[a].name.toLowerCase()){if(e.pin&&e.pin.pin||!O.options.isPINAuthentication){i[a]=o[a]=null;continue}}else if(""!==o[a].Parent&&void 0!==o[a].Parent&&null!==o[a].Parent){if(o[a].Parent&&e[o[a].Parent.toLowerCase()]&&void 0!==e[o[a].Parent.toLowerCase()]){var s=-1!==o[a].name.indexOf("_")?o[a].name.split("_")[1]:o[a].name,l=Object.keys(e[o[a].Parent.toLowerCase()]).length-1;if("object"!=typeof e[o[a].Parent.toLowerCase()]||!e[o[a].Parent.toLowerCase()][l]||!e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]){i[a].value=e[o[a].Parent.toLowerCase()][o[a].name.toLowerCase()],o[a]=null;continue}if(null!=e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]&&void 0!==e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]&&"unknown"!==e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]){i[a].value=e[o[a].Parent.toLowerCase()][l][s.toLowerCase()],o[a]=null;continue}}}else{if(0===o[a].name.indexOf("cf_")&&e.customfields&&e.customfields[o[a].name.replace("cf_","").toLowerCase()]){i[a].value=e.customfields[o[a].name.replace("cf_","").toLowerCase()],o[a]=null;continue}o[a].name&&"object"!=typeof e[o[a].name.toLowerCase()]&&null!=e[o[a].name.toLowerCase()]&&""!==e[o[a].name.toLowerCase()]&&void 0!==e[o[a].name.toLowerCase()]&&"unknown"!==e[o[a].name.toLowerCase()]&&(i[a].value=e[o[a].name.toLowerCase()],o[a]=null)}if(o=o.filter(function(e){return e}),t&&"profileeditor"===t&&!e.ErrorCode)return i=i.filter(function(e){return e});for(var u=0;u<o.length;u++)if(null!=o[u].rules&&""!==o[u].rules&&-1<o[u].rules.indexOf("required")||O.options.askOptionalFieldsOnRegistration&&!0===e.firstlogin&&"email"!==e.registrationprovider.toLowerCase()||O.options.askOptionalFieldsOnProgressiveSteps&&n||O.askPinOnLogin)return t&&!e.ErrorCode?i=i.filter(function(e){return e}):o;return[]},D.loginRadiusErrorTojsError=function(e){var o=[];return o.push(D.setMappedMessage(e)),o},D.setMappedMessage=function(e){for(var o=0;o<O.errorMessages.length;o++)O.errorMessages[o].code==e.ErrorCode&&(e.Message=O.errorMessages[o].message||e.Message,e.Description=O.errorMessages[o].description||e.Description);return e},D.setCustomLabel=function(e){for(var o=0;o<e.length;o++)e[o]&&O.formCustomLabel[e[o].name]&&(e[o].display=O.formCustomLabel[e[o].name])},D.setCustomTitle=function(e){for(var o=0;o<e.length;o++)e[o]&&O.formElementsTitle[e[o].name]&&(e[o].title=O.formElementsTitle[e[o].name])},D.setPlaceholder=function(e){for(var o=0;o<e.length;o++)e[o]&&O.formPlaceholder[e[o].name]&&(e[o].placeholder=O.formPlaceholder[e[o].name])},D.setValidation=function(e){O.formValidations[e.name]&&(e.rules=O.formValidations[e.name])},D.setAttribute=function(e,o){if(O.formElementAttributes[e.name])for(var t=O.formElementAttributes[e.name].split("&"),n=0;n<t.length;n++){var i=t[n].split("="),a=i.splice(0,1),r=i.join("=");o.setAttribute(a,r)}},D.verifyOTP=function(t,e,n,i,o,a,r){var s=!1,l="otp";O.LRCheck2FA&&(O.options.twoFactorAuthentication||O.options.optionalTwoFactorAuthentication)&&!O.LRCheckRegistration&&(s=!0,l="twofaotp");var u=O.otpSchema;D.createForm(u,l,e,function(e){var o;s?I.verify2FAOTPController(e,n,i,a,r):(("string"==typeof t||t instanceof String)&&(t=O.util.parseQueryString(t)),e=O.util.parseQueryString(e),t.phone?o={phone:t.phone}:(t.phoneid||t.phoneId)&&(o={phone:t.phoneid||t.phoneId}),t.onetouchloginflag&&(e.onetouchloginflag=!0),t.haveToken&&(e.haveToken=!0),I.verifyOTPController(e,o,n,i,a,r))},function(e){i(e)},o)},D.resendOTP=function(e,t,n,i,o,a,r,s){var l={},u=!0;("string"==typeof e||e instanceof String)&&(e=O.util.parseQueryString(e)),e.noPhoneVerified&&(u=!1);var c=!0;e.phoneid||e.phoneId?(c=!1,l={phone:e.phoneid||e.phoneId}):e.phone?(O.socialLoginFlag||(c=!1),l=e):e.phoneNo2FA||e.phoneno2fa?l={phoneno2fa:e.phoneNo2FA||e.phoneno2fa}:e.SecondFactorAuthentication&&e.SecondFactorAuthentication.OTPPhoneNo&&(l={phoneno2fa:e.SecondFactorAuthentication.OTPPhoneNo});var p=O.util.getButtonAttribute("resendotp",o),d=o||LoginRadiusDefaults.classPrefix,m=c?"twofaotp":"otp",g=document.getElementsByName(d+m)[0];g||(m="twofaotp"==m?"otp":"twofaotp",g=document.getElementsByName(d+m)[0]),g&&g.appendChild(p),!O.LRCheckLogin||!c||u&&"false"!==O.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)||D.changeNumberForm(t,g,n,i,d,"",a,r),e.onetouchloginflag&&(l.onetouchloginflag=!0),e.updatePhone&&(l.updatePhone=!0),O.util.addEvent("click",p,function(e){var o;O.options.disableResendOTPButton&&O.util.disableResendOTPButton(e),s?(o=O.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&D.isValidToken(o,i)&&O.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+O.options.apiKey+"&access_token="+o+"&smsTemplate="+O.options.smsTemplateUpdatePhone,l,function(e){e.ErrorCode&&i(D.loginRadiusErrorTojsError(e))},"updatePhone"):D.resendOTPManually(l,t,n,i,d,a,r)})},D.sendInstantSignInLink=function(e,o,t,n,i){var a,r,s=O.util.parseQueryString(e),l=s.emailid||s.email;LoginRadiusDefaults.regexExpression.emailRegex.test(l)||O.options.usernameLogin||O.options.duplicateEmailWithUniqueUsername?(LoginRadiusDefaults.regexExpression.emailRegex.test(l)?a="email="+l:(O.options.usernameLogin||O.options.duplicateEmailWithUniqueUsername)&&(a="username="+l),r=O.options.instantLinkLoginEmailTemplate||O.options.passwordlessLoginEmailTemplate,O.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email?apiKey="+O.options.apiKey+"&verificationUrl="+O.options.verificationUrl+"&passwordlesslogintemplate="+r+"&"+a,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?t(D.loginRadiusErrorTojsError(e)):o(e)},"passwordlessLogin")):t([D.setMappedMessage(A.invalidEmail)])},D.sendInstantSignInOtp=function(e,n,i,t,a){var r,s,o=O.util.parseQueryString(e),l=o.emailid||o.email;LoginRadiusDefaults.regexExpression.phoneRegex.test(l)?(r="phone="+l,s=O.options.smsTemplateInstantOTPLogin||O.options.passwordlessLoginSMSTemplate,O.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+O.options.apiKey+"&"+r+"&smsTemplate="+s,"",function(e){var o;window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?i(D.loginRadiusErrorTojsError(e)):(n(e),e.Data&&e.Data.Sid&&(O.$hooks.register("beforeFormRender",function(e,o){var t;O.util.findInSchema(o,"name","resendotp")||(t=Object.assign({},O.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){O.options.disableResendOTPButton&&O.util.disableResendOTPButton(e);var o={data:r,onsuccess:n,onerror:i,smstemplate:s,action:"sendInstantSignInResendOtp"};D.resendOTPHandler(o)}}),o.push(t))}),o=O.otpSchema,D.createForm(o,"otp",t,function(e){var o=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";I.verifyInstantOTP(e,O.util.parseQueryString(r),n,i,o,t,a)},function(e){i(D.setMappedMessage(e))},a)))},"passwordlessLogin")):i([D.setMappedMessage(A.invalidPhone)])},D.resendOTPManually=function(e,o,t,n,i,a,r){var s,l=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";O.LRCheck2FA&&(O.options.twoFactorAuthentication||O.options.optionalTwoFactorAuthentication)&&!O.LRCheckRegistration?"false"===O.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)?(s={data:e,onsuccess:t,onerror:n,smstemplate:O.options.smsTemplate2FA,action:"update2FANumberResendOTP"},D.resendOTPHandler(s)):I.resendOTP2FAController(e,t,n,l,o,i):I.resendOTPController(e,t,n,l,o,i)},D.updatePhoneNumber=function(o,t,n,i,e,a,r){O.LRCheck2FA&&(O.options.twoFactorAuthentication||O.options.optionalTwoFactorAuthentication)&&(O.checkPhoneNumberSchema[0].name="phoneNo2FA"),i=i||LoginRadiusDefaults.classPrefix,document.getElementsByName(i+"showQRcode")[0]&&(LoginRadiusDefaults.innerHTML=!0);var s=e||"updatePhone";D.createForm(O.checkPhoneNumberSchema,s,o,function(e){-1===e.indexOf("phone=")&&(O.options.twoFactorAuthentication||O.options.optionalTwoFactorAuthentication)?I.update2FAPhoneNumberController(e,o,t,n,i,a,r):I.updatePhoneNumberController(e,o,t,n,i,a,r)},function(e){n(e)},i)},D.pingForSmartLogin=function(o,t,n){var i=O.options.autoLoginPingInterval||O.options.smartLoginPingInterval,a=O.options.autoLoginPingCount||O.options.smartLoginPingCount;O.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin/ping?apiKey="+O.options.apiKey+"&clientGuid="+o,"",function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(D.pingForSmartLogin(o,t,n),LoginRadiusDefaults.pingCount++)},1e3*i):e.ErrorCode&&1139!==e.ErrorCode?(n(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,t(e))},"pingSmartLogin")},D.pingForCrossDeviceSSO=function(o,t,n,i){var a=O.options.crossDeviceSSOPingInterval,r=O.options.crossDeviceSSOPingCount,s=1;O.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/token?apiKey="+O.options.apiKey+"&code="+o,"",function(e){e&&null===e.access_token?O.CDSSOPingApiTimeout=setTimeout(function(){s<r&&(D.pingForCrossDeviceSSO(o,t,n,i),s++)},1e3*a):(s=0,i(),t(e))},"pingForCrossDeviceSSO")},D.generateCrossDeviceSSOCode=function(a,e,r,s,l,u){var o=e||"60";60<+o?O.log("QR code expiry time should not be more than 60 seconds."):O.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/generate?apikey="+O.options.apiKey+"&expiry="+o,"",function(e){var t,o,n,i;e.ErrorCode?s(D.loginRadiusErrorTojsError(e)):e&&e.code&&(t=[],QRCode.toDataURL(e.code,function(e,o){t.push({type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:o})}),o=l||LoginRadiusDefaults.idPrefix,n=l||LoginRadiusDefaults.classPrefix,(i=document.createElement("div")).setAttribute("name",o+"crossDeviceSSO"),D.createFormFields(t,i,"crossDeviceSSO",[],n,o,s),O.util.addHTMLContent(a,i,LoginRadiusDefaults.innerHTML),D.pingForCrossDeviceSSO(e.code,function(e){D.loginHandleToken(e,"",r,s,"",!0)},s,u))},"crossDeviceSSO")},D.addChangeEventHandler=function(u,e,o,c){O.util.addEvent("change",document.getElementById(c+"registration-"+e.name),function(e){O.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+o.DataSource+"?apiKey="+O.options.apiKey+"&parentId="+this.value,"",function(e,o){var t=document.getElementById(c+"registration-"+e.name);if(o.ErrorCode)for(var n=1;n<t.options.length;n++)t.options[n]=null;else for(var i=0;i<o.length;i++)if(0===i&&1<t.options.length){for(var a=1;a<t.options.length;a++)t.options[a]=null;var r=document.createElement("option");r.setAttribute("value",o[i].Id),r.appendChild(document.createTextNode(o[i].Key)),t.appendChild(r)}else{var s=document.createElement("option");s.setAttribute("value",o[i].Id),s.appendChild(document.createTextNode(o[i].Key)),t.appendChild(s)}for(var l=0;l<e.children.length;l++)D.addChangeEventHandler(u,e,e.children[l],c)},"registration",o)})},D.createFormFields=function(e,o,c,t,n,i,a){var p;a=a||function(){};function r(e){var o=Math.random(),t=this.value,n=O.util.elementById(c+"-password-strength-meter"),i=O.util.elementById(c+"-password-strength-text");i.innerHTML="";var a=0;0<t.length&&(a++,t.match(/[a-z]/)&&t.match(/[A-Z]/)&&a++,t.match(/\d+/)&&a++,t.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)&&a++,12<t.length&&a++),n.value=a;var r=document.getElementsByClassName(c+"-password");if(0<r.length)for(var s=0;s<r.length;s++)r[s].parentNode.removeChild(r[s]);var l=O.util.elementById(o)?O.util.elementById(o):document.createElement("style");l.type="text/css",l.id=o,l.setAttribute("class",c+"-password");var u=-1!==navigator.userAgent.indexOf("Firefox");l.innerHTML=u?"#"+c+"-password-strength-meter::-moz-meter-bar { background: "+p[a].color+" !important; }":"#"+c+"-password-strength-meter::-webkit-meter-optimum-value { background: "+p[a].color+" !important; }",document.body.appendChild(l),""!==t&&0<a?(i.innerHTML="Strength: "+p[a].Message,i.style.color=""):""!==t&&(i.innerHTML=p[a].Message,i.style.color=p[a].color)}for(var s,l=0;l<e.length;l++)if(e[l]){switch(D.setValidation(e[l]),e[l].rules&&""!==e[l].rules&&-1<e[l].rules.indexOf("custom_validation")&&-1===e[l].rules.indexOf("callback_custom_validation")&&(e[l].rules=e[l].rules.replace(/custom_validation\b/g,"callback_custom_validation")),t[l]={},t[l].name=e[l].name,t[l].display=e[l].display,t[l].rules=e[l].rules,e[l].type){case"text":s=document.createElement("textarea");break;case"html":case"captcha":s=document.createElement("div");break;case"password":(s=document.createElement("input")).type="password";break;case"hidden":(s=document.createElement("input")).type="hidden",s.value=e[l].value||"";break;case"option":s=document.createElement("select");var u=document.createElement("option");if(u.appendChild(document.createTextNode("-- select --")),u.setAttribute("value",""),s.appendChild(u),null==e[l].DataSource&&null!=e[l].options){for(var d=0;d<e[l].options.length;d++){var m=document.createElement("option");m.setAttribute("value",e[l].options[d].value),"country"===e[l].name&&m.setAttribute("value",e[l].options[d].value+"|"+e[l].options[d].text),m.appendChild(document.createTextNode(e[l].options[d].text)),s.appendChild(m)}O.defaultOptionField[e[l].name]&&(s.value=O.defaultOptionField[e[l].name])}break;case"multi":(s=document.createElement("input")).type="checkbox";break;case"email":(s=document.createElement("input")).type="email";break;case"button":(s=document.createElement("input")).type="button",s.value=e[l].display;break;case"image":(s=document.createElement("img")).src=e[l].value,s.type="image";break;default:(s=document.createElement("input")).type="text"}if(e[l].title&&(s.title=e[l].title),e[l].disabled&&(s.disabled=e[l].disabled),D.setAttribute(e[l],s),e[l].placeholder&&(s.placeholder=e[l].placeholder),e[l].value&&("multi"===e[l].type?s.checked=!0:s.value=e[l].value),"html"===e[l].type){var g=document.createElement("div");if(g.setAttribute("class",n+"-form-element-content content-"+i+e[l].name),g.innerHTML=e[l].html,e[l].event&&O.util.addEvent(e[l].event,g,e[l].eventCallback),"consent"===e[l].name)for(var f=g.getElementsByTagName("input"),h=0;h<f.length;h++)f[h].setAttribute("id",i+c+"-"+f[h].name);o.appendChild(g)}else if("captcha"===e[l].type){var y,v=document.createElement("div");v.setAttribute("class",n+"-form-element-content content-"+i+e[l].name),v.innerHTML=e[l].html,O.options.formValidationMessage&&((y=document.createElement("div")).setAttribute("id","validation-"+i+c+"-"+e[l].name),y.setAttribute("class",n+"validation-message validation-"+i+e[l].name),v.appendChild(y)),o.appendChild(v)}else{if(s.setAttribute("name",e[l].name),"registration"===c&&(e[l].name&&("phoneid"===e[l].name.toLowerCase()||"phone"===e[l].name.toLowerCase())&&O.options.existPhoneNumber&&O.util.addEvent("blur",s,function(e){var o,t;t=a,""!==(o=e).target.value.trim()&&I.checkPhoneNumberAvailabilityController("phone="+o.target.value,function(e){e.IsExist?-1!==o.target.parentNode.getAttribute("class").indexOf("phoneid")&&(o.target.parentNode.childNodes[2].innerHTML="phone already exists, enter unique phone number"):-1!==o.target.parentNode.getAttribute("class").indexOf("phoneid")&&(o.target.parentNode.childNodes[2].innerHTML="")},t)}),e[l].name&&"username"===e[l].name.toLowerCase()&&O.options.existUsername&&O.util.addEvent("blur",s,function(e){var o,t;t=a,""!==(o=e).target.value.trim()&&I.checkUserNameAvailabilityController("username="+o.target.value,function(e){e.IsExist?-1!==o.target.parentNode.getAttribute("class").indexOf("username")&&(o.target.parentNode.childNodes[2].innerHTML="username already exists, enter unique username"):-1!==o.target.parentNode.getAttribute("class").indexOf("username")&&(o.target.parentNode.childNodes[2].innerHTML="")},t)})),"emailid"===e[l].name&&O.util.addEvent("keyup",s,function(e){32===e.keyCode&&(this.value=this.value.trim())}),s.setAttribute("id",i+c+"-"+e[l].name),e[l].event&&O.util.addEvent(e[l].event,s,e[l].eventCallback),O.eventsName[s.id]){var C=O.eventsName[s.id];if(O.util.isArray(C))for(var w=0;w<C.length;w++)C[w].event&&C[w].eventCallback&&O.util.addEvent(C[w].event,s,C[w].eventCallback);else O.util.addEvent(C.event,s,C.eventCallback)}if("hidden"===e[l].type)o.appendChild(s);else if("button"===e[l].type){var T=document.createElement("div");T.setAttribute("class",n+"-form-element-content content-"+i+e[l].name),T.appendChild(s),o.appendChild(T)}else{var S=document.createElement("label");S.setAttribute("for",i+c+"-"+e[l].name),S.innerHTML=e[l].display,s.setAttribute("class",n+e[l].type+" "+i+e[l].name),e[l].rules&&-1!==e[l].rules.indexOf("required")&&(s.className+=" lr-required");var k,L=document.createElement("div");if(L.setAttribute("class",n+"-form-element-content content-"+i+e[l].name),"multi"===e[l].type?(L.appendChild(s),L.appendChild(S)):(L.appendChild(S),L.appendChild(s)),e[l].style&&0<e[l].style.length)for(var P=0;P<e[l].style.length;P++)L.style[e[l].style[P].key]=e[l].style[P].value;if(O.options.formValidationMessage&&((k=document.createElement("div")).setAttribute("id","validation-"+i+c+"-"+e[l].name),k.setAttribute("class",n+"validation-message validation-"+i+e[l].name),L.appendChild(k)),O.options.displayPasswordStrength&&("password"===s.name||"newpassword"===s.name)&&("registration"===c||"resetpassword"===c||"setpassword"===c||"changepassword"===c||"socialRegistration"===c||"loginRequiredFieldsUpdate"===c)){O.options.passwordLength&&O.options.passwordLength.min,O.options.passwordLength&&O.options.passwordLength.max;if(e[l].rules)for(var R=e[l].rules.split("|"),b=0;b<R.length;b++)-1<R[b].indexOf("min_length")?R[b].substring(11,R[b].length-1):-1<R[b].indexOf("max_length")&&R[b].substring(11,R[b].length-1);var E=document.createElement("meter");E.setAttribute("max","4"),E.setAttribute("id",c+"-password-strength-meter");var A=document.createElement("div");A.setAttribute("id",c+"-password-strength-text"),s.parentNode.appendChild(E),s.parentNode.appendChild(A),p=F(),O.util.addEvent("keyup",s,r)}o.appendChild(L)}}}},D.setToken=function(e){LRNameSpace.cookies.setItem(LoginRadiusDefaults.tokenCookie,e,"",O.options.appPath)},D.resetGoogleCaptcha=function(e,o){var t;O.options.optionalRecaptchaConfiguration.IsEnabled&&"registration"!==e&&(t=O.util.elementById(o,!0),window.grecaptcha&&t&&""!==t.innerHTML&&grecaptcha.reset(window[o+"lr_recaptcha_widgets_idprefix"]))},D.createForm=function(e,c,o,p,d,m){var t,n,g=m||LoginRadiusDefaults.idPrefix,f=m||LoginRadiusDefaults.classPrefix;if(O.LRPrefix=m+"##"+LoginRadiusDefaults.idPrefix,("Captcha"===O.options.loginLockedType&&"registration"!==c||O.options.optionalRecaptchaConfiguration.IsEnabled)&&(n=O.options.optionalRecaptchaConfiguration.Apis,("Captcha"===O.options.loginLockedType||n&&S(c,n))&&(t=m+LoginRadiusDefaults.idPrefix+"recaptcha_widget_"+c.toLowerCase(),O.util.addRecaptchaJS(),O.util.captchaSchema(t,e))),O.$hooks.call("beforeFormRender",c,e),LoginRadiusDefaults._uuidFormat.test(O.options.apiKey)){if(LoginRadiusDefaults.isRegFormSchemaLock=!1,LoginRadiusDefaults.isSecurityFormSchemaLock=!1,D.setCustomLabel(e),D.setPlaceholder(e),D.setCustomTitle(e),0<e.length){var i=[],h=document.createElement("form");h.setAttribute("name",g+c),h.setAttribute("method","POST"),D.createFormFields(e,h,c,i,f,g,d);var a,r=document.createElement("input"),s=O.buttonsName[c.toLowerCase()]||C[c.toLowerCase()],l=C[c.toLowerCase()].toLowerCase().replace(/ /g,"-");r.type="submit",O.options.isPINAuthentication&&"loginRequiredFieldsUpdate"===c&&O.util.findInSchema(e,"name","pin")?r.value="Continue":r.value=s,r.id=g+"submit-"+l,r.setAttribute("class",f+"submit submit-"+g+l),O.options.disableButtonOnsubmit&&(O.$hooks.register("eventCalls",function(e){window.lrpasswordlessloginotp||window.lrpasswordlesslogin||(a=e)}),O.$hooks.register("startProcess",function(e){a===c&&(r.disabled=!0)}),O.$hooks.register("xhrEndWithError",function(e){a===c&&(r.disabled=!1)}),O.$hooks.register("xhrEndWithSuccess",function(e){a===c&&O.options.enableSubmitOnSuccess&&(r.disabled=!1)})),h.appendChild(r),O.options.passwordlessLogin&&"login"===c&&T("passwordlessloginbuttonlabel",h,r,g,f),O.options.passwordlessLoginOTP&&"login"===c&&T("passwordlessLoginOTPButtonLabel",h,r,g,f),O.util.addHTMLContent(o,h,LoginRadiusDefaults.innerHTML),O.$hooks.call("afterFormRender",c,o,f,h),LoginRadiusDefaults.innerHTML=!1;var u,y=new FormValidator(g+c,i,function(e,o){var t=document.getElementsByTagName("form"),n="";if(t[g+c])n=t[g+c];else if("object"==typeof t)for(var i=0;i<t.length;i++)if(t[i].name===g+c){n=t[i];break}O.currentLRContainer=n.parentElement.id,O.$hooks.call("eventCalls",c,f),O.mergeFormErrors&&0<O.mergeFormErrors.length&&(e=O.util.mergeObjects(e,O.mergeFormErrors));for(var a=O.util.elementsByClass(f+"validation-message"),r=0;r<a.length;r++)a[r].innerHTML="";var s=m+g+"recaptcha_widget";s+="_"+c.toLowerCase();var l=O.util.elementById(s+"_tencent");if(O.options.invisibleRecaptcha&&(window.onCaptchaSubmit=function(e){p(O.util.serialize(h)),grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"])}),l&&"none"!==l.style.display&&(O.options.tencentCaptcha||O.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&0==e.length&&l.click(),0<e.length){O.$hooks.call("afterValidation",c);for(var u=0;u<e.length;u++)if(e[u].Id===g+""+c+"-password"&&"login"===c&&(O.options.passwordlessLogin&&window.lrpasswordlesslogin||O.options.passwordlessLoginOTP&&window.lrpasswordlessloginotp)){if(1===e.length||0===e.length)return w(h,p,s,c),D.resetGoogleCaptcha(c,s),!0}else O.options.formValidationMessage&&"resettoken"!==e[u].Name&&(O.util.elementById("validation-"+g+c+"-"+e[u].Name).innerHTML=e[u].Message);O.options.formValidationMessage||(d(e),D.resetGoogleCaptcha(c,s))}else w(h,p,s,c),D.resetGoogleCaptcha(c,s);o&&o.preventDefault?o.preventDefault():event&&(event.returnValue=!1)});if(O.validationMessages&&0<O.validationMessages.length)for(var v=0;v<O.validationMessages.length;v++)y.setMessage(O.validationMessages[v].rule,O.validationMessages[v].message),"valid_date"!==O.validationMessages[v].rule&&"callback_valid_date"!==O.validationMessages[v].rule||(u=O.validationMessages[v].message);y.registerCallback("valid_date",function(e){var o=e.split("/");-1!==e.indexOf("-")&&(o=e.split("-"));var t=parseInt(o[1],10),n=parseInt(o[0],10),i=parseInt(o[2],10);if(i<1e3||3e3<i||0===n||12<n)return!1;var a=[31,28,31,30,31,30,31,31,30,31,30,31];return(i%400==0||i%100!=0&&i%4==0)&&(a[1]=29),0<t&&t<=a[n-1]}).setMessage("valid_date",u||"The %s field must contain a valid date."),y.registerCallback("custom_validation",function(e,o){o=(o=o.split("###")[0]).split("or").join("|");try{return new RegExp(o,"g").test(e)?!0:!1}catch(e){return O.log("Invalid custom validation regex expression"),!1}}).setMessage("custom_validation","The %s field is not valid."),O.Validator=y}}else O.log("apiKey is not in valid guid format.");O.options.optionalRecaptchaConfiguration.IsEnabled&&n&&S(c,n)&&"registration"!==c&&O.util.renderV2Recaptcha(t,!0)},D.createConsentInterface=function(e,o){var t="";if(e){for(var n=0;n<e.ConsentForm.length;n++)if("Group"===e.ConsentForm[n].Type){if(e.ConsentForm[n].Consents.length){var i={consentGroupTitle:e.ConsentForm[n].Title,consentGroupDescription:e.ConsentForm[n].Description};t+=O.util.hashTmpl(LoginRadiusDefaults.templates.consentGroupTemplate,i);for(var a=0;a<e.ConsentForm[n].Consents.length;a++){var r={consentTitle:e.ConsentForm[n].Consents[a].Title,consentDescription:e.ConsentForm[n].Consents[a].Description,consentId:"consent_"+e.ConsentForm[n].Consents[a].ConsentId};t+=O.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,r)}}}else if("Consent"===e.ConsentForm[n].Type)for(var s=0;s<e.ConsentForm[n].Consents.length;s++){var l={consentTitle:e.ConsentForm[n].Consents[s].Title,consentDescription:e.ConsentForm[n].Consents[s].Description,consentId:"consent_"+e.ConsentForm[n].Consents[s].ConsentId};t+=O.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,l)}if(t+=O.util.hashTmpl(LoginRadiusDefaults.templates.consentMainTemplate,e),o){var u=document.createElement("div");u.innerHTML=t.trim();for(var c=0;c<o.length;c++){var p=u.querySelector('input[name="consent_'+o[c].ConsentOptionId+'"]');p&&p.setAttribute("checked","checked")}t=u.innerHTML?u.innerHTML:""}}return t},D.createConsentOptionInterface=function(e,o){var t="";if(e){for(var n in e){var i={consentTitle:e[n].Title,consentDescription:e[n].Description,consentId:"consent_"+e[n].ConsentId,checked:!!e[n].checked};t+=O.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,i)}if(o){var a=document.createElement("div");a.innerHTML=t.trim();for(var r=0;r<o.length;r++){e[o[r].ConsentOptionId]&&a.querySelector('input[name="consent_'+o[r].ConsentOptionId+'"]').setAttribute("checked","checked")}t=a.innerHTML?a.innerHTML:""}}return t},D.setConsentTemplate=function(){var e,o,t,n,i,a=document.getElementById(LoginRadiusDefaults.templates.consentMainTemplate);a&&((e=document.createElement("div")).innerHTML=a.innerHTML,a.append(e),(o=document.createElement("script")).type="text/html",o.id=LoginRadiusDefaults.templates.consentOptionTemplate,o.innerHTML=this.decodeHtml(document.getElementById(LoginRadiusDefaults.templates.consentOptionTemplate).innerHTML),!(t=document.getElementById(LoginRadiusDefaults.templates.consentGroupTemplate))||(n=t.querySelectorAll("#"+LoginRadiusDefaults.templates.consentOptionTemplate)[0])&&n.remove(),(i=document.createElement("script")).type="text/html",i.id=LoginRadiusDefaults.templates.consentGroupTemplate,i.innerHTML=this.decodeHtml(t.innerHTML),t.remove(),a.innerHTML=this.decodeHtml(e.innerHTML),e.remove(),document.body.append(i),document.body.append(o))},D.consentValidation=function(e,o){var t=O.util.parseQueryString(e),n=[];if(o){if(O.consentOptions[o]&&O.consentOptions[o].ConsentForm)for(var i=O.consentOptions[o].ConsentForm,a=0;a<i.length;a++)var r=i[a],n="Group"===r.Type?D.setConsentValidation(r,t,n,!0):D.setConsentValidation(r,t,n)}else{var s,l={Type:"Consent",Consents:[]};for(s in O.consentsList)l.Consents.push(O.consentsList[s]);n=D.setConsentValidation(l,t,n)}return n},D.setConsentValidation=function(e,o,t,n){var i=!1;if(n&&e.IsRequiredAtleastOne&&0===e.Consents.length)t.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group should have at least one consent"});else{for(var a=0;a<e.Consents.length;a++)n&&e.IsRequiredAtleastOne&&"true"===o["consent_"+e.Consents[a].ConsentId]&&(i=!0),e.Consents[a].IsRequired&&"true"!==o["consent_"+e.Consents[a].ConsentId]&&t.push({Id:e.Consents[a].ConsentId,Name:e.Consents[a].Title,Message:e.Consents[a].Title+" consent is required"});e.IsRequiredAtleastOne&&!i&&t.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group at least one consent is required"})}return t},D.isValidToken=function(e,o){return!!e||(o([D.setMappedMessage(A.tokenValid)]),!1)},D.decodeHtml=function(e){var o=document.createElement("textarea");return o.innerHTML=e,o.value},D.checkForLatestPrivacyPolicy=function(e){for(var o=O.options.privacyPolicyConfiguration.PrivacyPolicies,t=(new Date).getTime(),n={},i=0;i<o.length;i++)new Date(o[i].StartDateTime).getTime()<t&&(O.util.isEmpty(n)||!O.util.isEmpty(n)&&new Date(n.StartDateTime).getTime()<new Date(o[i].StartDateTime).getTime())&&(n=o[i]);return n.Version===e.PrivacyPolicy.Version},D.sanitizePinData=function(e){var o=Object.assign({},e),t={PIN:"",Skipped:null};return o.hasOwnProperty("pin")&&o.pin?t.PIN=o.pin:t.Skipped=!0,delete o.pin,o.PINInfo=t,o},D.sanitizeSecurityQuesData=function(e){var o,t=O.util.parseQueryString(e),n={},i=["email","username","phone","password","pin","phoneApi"];for(o in t)-1===i.indexOf(o)&&(n[o]=t[o],delete t[o]);return t.securityanswer=n,t},D.loadQRCodeScript=function(e){var o;O.options.isCrossDeviceSSOEnabled&&((o=document.createElement("script")).src=LoginRadiusDefaults.externalLibrary+"qrcode.js",o.type="text/javascript",o.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(o))},D.resendOTPHandler=function(o){var e,t;"update2FANumberResendOTP"===o.action?(e=O.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),(t=O.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&!O.LRCheckLogin?O.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+O.options.apiKey+"&access_token="+t+"&smsTemplate="+o.smstemplate,o.data,function(e){e.ErrorCode?o.onerror(D.loginRadiusErrorTojsError(e)):o.onsuccess(e,o.data)},"updatePhone"):e?O.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+O.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+o.smstemplate,o.data,function(e){e.ErrorCode?o.onerror(D.loginRadiusErrorTojsError(e)):o.onsuccess(e,o.data)},"login"):o.onerror([D.setMappedMessage(A.twofaTokenValid)])):"smartLoginResendOTP"===o.action?O.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/otp?apiKey="+O.options.apiKey+"&phone="+o.data+"&smsTemplate="+o.smstemplate,"",function(e){e.ErrorCode?o.onerror(D.loginRadiusErrorTojsError(e)):o.onsuccess(e)},"loginOTP"):"sendInstantSignInResendOtp"===o.action&&O.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+O.options.apiKey+"&"+o.data+"&smsTemplate="+o.smstemplate,"",function(e){e.ErrorCode?o.onerror(D.loginRadiusErrorTojsError(e)):o.onsuccess(e)},"passwordlessLogin")}}function LoginRadiusControllers(w,T){var S=LoginRadiusDefaults.messages,k=this;function i(e,o,t,n,i){o?w.util.ajaxCall(e,LoginRadiusDefaults.apiDomain+"/auth/customobject/"+t+"?apiKey="+w.options.apiKey+"&access_token="+o+"&objectname="+w.options.customObjectName,"",function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):n(e)},"CustomObject"):i([T.setMappedMessage(S.twofaTokenValid)])}k.handleFeatures=function(e,o,t,n,i,a,r){var s,l,u,c,p,d,m,g,f=e.Profile;"string"!=typeof o&&(o=w.util.jsonToQueryString(o)),n&&w.options.periodicPasswordReset&&f.PasswordExpirationDate&&new Date(f.PasswordExpirationDate)<=new Date?(T.setPasswordRule(w.changePasswordFormSchema[1]),T.setPasswordRule(w.changePasswordFormSchema[2]),n(f,e)):t&&(w.options.askRequiredFieldForTraditionalLogin||LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin||w.askPinOnLogin)?(s=f,l=e,u=o,c=t,p=i,d=a,w.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,l.access_token),w.options.isPINAuthentication&&w.options.PINConfiguration.PINLogin&&l&&l.session_token&&w.setSessionToken(l),m=w.options,g=(g=JSON.parse(JSON.stringify(m))).RegistrationFormSchema,s.IsDeleted?d(T.loginRadiusErrorTojsError(s)):(w.options.autoFilledFieldForTraditional&&w.$hooks.register("beforeFormRender",function(e,o){var t,n;"loginRequiredFieldsUpdate"===e&&((t=w.util.findInSchema(o,"name","emailid"))&&t.value&&(t.disabled=!0),(n=w.util.findInSchema(o,"name","phoneid"))&&n.value&&(n.disabled=!0))}),w.registrationFormSchema=T.mapSchema(g,s,w.options.autoFilledFieldForTraditional),0<w.registrationFormSchema.length?(T.setPasswordRule(w.util.findInSchema(g,"name","password")),T.setPasswordRule(w.util.findInSchema(g,"name","confirmpassword")),w.$hooks.call("registrationSchemaFilter",g,s),c(s,l,l.access_token,u,p,d)):T.loginHandleToken(l,u,p,d))):T.loginHandleToken(e,o,i,a,r)},k.verifyOTPController=function(o,e,t,n,i,a){var r=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+w.options.apiKey+"&otp="+o.otp+"&smsTemplate="+w.options.smsTemplateWelcome;o.haveToken&&(r+="&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)),o.onetouchloginflag&&(r=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone/verify?apiKey="+w.options.apiKey+"&otp="+o.otp+"&smsTemplate="+w.options.smsTemplateOneTouchLoginWelcome),w.util.ajaxCall("put",r,e,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):o.onetouchloginflag&&!w.options.askRequiredFieldsOnPasswordLessLogin?T.loginHandleToken(e,"",t,n,"",!0):e.access_token?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,k.handleFeatures(e,o,a,i,t,n)):t(e,o)},"verifyOTP")},k.updateSecurityQuestionController=function(e,o,t){for(var n=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i=w.util.parseQueryString(e),a=0;a<w.options.securityQuestionsCount;a++)i[i["securityQuestion"+a]]=i["securityAnswer"+a],delete i["securityQuestion"+a],delete i["securityAnswer"+a];var r={SecurityQuestionAnswer:i};T.isValidToken(n,t)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apikey="+w.options.apiKey+"&access_token="+n,r,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"updateSecurityQuestion")},k.resetTwoFactorAuthenticationController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i={};i[o]=!0,T.isValidToken(e,n)&&w.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/authenticator?apikey="+w.options.apiKey+"&access_token="+e,i,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"resetTwoFactorAuthentication")},k.forgotPasswordController=function(t,n,i,a,r){var e=w.options.forgotPasswordUrl||w.options.resetPasswordUrl;w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password?apiKey="+w.options.apiKey+"&resetPasswordUrl="+e+"&emailTemplate="+w.options.resetPasswordEmailTemplate,t,function(e){var o;e.ErrorCode?a(T.loginRadiusErrorTojsError(e)):(o=w.util.parseQueryString(t),i(e,o),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&T.resetPassword(n,i,a,r,o))},"forgotPassword")},k.forgotPINController=function(t,n,i,a,r){var e=w.util.parseQueryString(t).hasOwnProperty("username")?"username":"email",o=w.options.forgotPINUrl||w.options.resetPINUrl;w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/"+e+"?apiKey="+w.options.apiKey+"&resetPINUrl="+o+"&emailTemplate="+w.options.resetPINEmailTemplate,t,function(e){var o;e.ErrorCode?a(T.loginRadiusErrorTojsError(e)):(o=w.util.parseQueryString(t),i(e,o),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&T.resetPIN(n,i,a,r,o))},"forgotPIN")},k.loginController=function(t,n,i,a,r,s,l,u,c){w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate;var e="emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl;w.options.phoneLogin&&(e+="&smsTemplate="+w.options.smsTemplatePhoneVerification),w.options.riskBasedAuthentication&&(e+="&RbaOneclickEmailTemplate="+w.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+w.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+w.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+w.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+w.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+w.options.rbaIpEmailTemplate+"&RbaCitySmsTemplate="+w.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+w.options.rbaCountrySmsTemplate,e+="&RbaBrowserSmsTemplate="+w.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+w.options.rbaIpSmsTemplate),("string"==typeof(t=w.util.checkPhoneOrEmailLogin(t))||t instanceof String)&&(t=w.util.parseQueryString(t)),w.options.duplicateEmailWithUniqueUsername&&(delete t.email,delete t.phoneid);var o=LoginRadiusDefaults.apiDomain+"/auth/login?apiKey="+w.options.apiKey+"&loginUrl="+w.options.loginUrl+"&"+e;t["g-recaptcha-response"]&&(o+="&g-recaptcha-response="+t["g-recaptcha-response"],delete t["g-recaptcha-response"]),t.qq_captcha_randstr&&(o+="&qq_captcha_randstr="+t.qq_captcha_randstr,delete t.qq_captcha_randstr),t.qq_captcha_ticket&&(o+="&qq_captcha_ticket="+t.qq_captcha_ticket,delete t.qq_captcha_ticket),w.util.ajaxCall("post",o,t,function(e){var o;w.options.stayLogin&&w.storage.setBrowserStorage("lr-rememberme",t.stayLogin),e.ErrorCode?("970"==e.ErrorCode&&w.options.otpEmailVerification&&!w.options.verifyEmailByOTP?T.otpEmailVerification(n,i,a,l,t):"1167"==e.ErrorCode&&(e.PhoneId||t.phone)?(delete t.email,t.phone=e.PhoneId||t.phone,k.loginOTPController(t,n,i,a,l,"no")):w.options.phoneLogin&&"1066"==e.ErrorCode&&(T.verifyOTP=u||T.verifyOTP,T.resendOTP=c||T.resendOTP,T.verifyOTP(t,n,i,a,l,r,s),T.resendOTP(t,n,i,a,l,r,s)),a(T.loginRadiusErrorTojsError(e))):(w.askPinOnLogin=!1,o=e.Profile,w.options.isPINAuthentication&&o&&(w.options.PINConfiguration.AskOnlyOnFirstLogin&&o.FirstLogin||w.options.PINConfiguration.AskOnLogin)&&(null!==o.PIN&&o.PIN.PIN||(w.askPinOnLogin=!0)),k.handleFeatures(e,t,s,r,i,a,l))},"login")},k.loginOTPController=function(e,t,n,i,a,o){var r,s,l=e=w.util.checkPhoneOrEmailLogin(e);("string"==typeof e||e instanceof String)&&(l=w.util.parseQueryString(e)),l.email||l.username?T.sendInstantSignInLink(e,n,i,t,a):(r=w.options.smsTemplateInstantOTPLogin||w.options.passwordlessLoginSMSTemplate,w.$hooks.register("beforeFormRender",function(e,o){w.util.findInSchema(o,"name","resendotp")||o.push({type:"button",name:"resendotp",display:"Resend OTP",rules:"",permission:"r",event:"click",eventCallback:function(e){w.options.disableResendOTPButton&&w.util.disableResendOTPButton(e);var o={data:l.phone,onsuccess:n,onerror:i,smstemplate:r,action:"smartLoginResendOTP"};T.resendOTPHandler(o)}})}),s=function(){var e=w.otpSchema;T.createForm(e,"otp",t,function(e){var o=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";k.verifyInstantOTP(e,l,n,i,o,t,a)},function(e){i(T.setMappedMessage(e))},a)},o?s():w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/otp?apiKey="+w.options.apiKey+"&phone="+l.phone+"&smsTemplate="+r,"",function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(n(e),s())},"loginOTP"))},k.loginPINController=function(o,e,t,n,i,a,r,s){w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,("string"==typeof o||o instanceof String)&&(o=w.util.parseQueryString(o));var l=LoginRadiusDefaults.apiDomain+"/auth/login/pin?apiKey="+w.options.apiKey+"&session_token="+s;w.util.ajaxCall("post",l,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):k.handleFeatures(e,o,r,a,t,n,i)},"login")},k.login2FAController=function(t,u,c,p,d,m,g,a,r,s){w.LRCheck2FA=!0,t=w.util.checkPhoneOrEmailLogin(t);var f=function(l,e,o){e=e||"",o=o||"";var t,n,i=w.util.getButtonAttribute("sendotp",d);w.options.googleAuthentication&&(!e&&w.options.twoFactorAuthentication||o)&&T.showQRCode(l,u,c,p,d,m,g),e||o||!w.options.twoFactorAuthentication?(!o&&w.options.twoFactorAuthentication||w.options.optionalTwoFactorAuthentication&&!e&&""!==l.SecondFactorAuthentication.OTPPhoneNo&&null!=l.SecondFactorAuthentication.OTPPhoneNo||e)&&(o?(d=d||LoginRadiusDefaults.classPrefix,w.options.googleAuthentication?(t=document.getElementsByName(d+"showQRcode")[0])&&t.appendChild(i):w.util.addHTMLContent(u,i)):(T.verifyOTP=r||T.verifyOTP,T.resendOTP=s||T.resendOTP,T.verifyOTP(l,u,c,p,d,m,g),T.resendOTP(l,u,c,p,d,m,g))):(T.updatePhoneNumber=a||T.updatePhoneNumber,T.updatePhoneNumber(u,c,p,d,"",m,g)),(e||o)&&(n=w.util.getButtonAttribute("backupcodebutton",d),w.util.addHTMLContent(u,n,!0),w.util.addEvent("click",n,function(e){var o,t,n,i,a,r;o=u,t=c,n=p,i=d,a=m,r=g,T.createForm(w.backupCodeFormSchema,"backupcode",o,function(e){k.backupCodeController(e,t,n,a,r)},function(e){n(e)},i);var s=w.util.getButtonAttribute("backupcodebackbutton",d);w.util.addHTMLContent(u,s,!0),w.util.addEvent("click",s,function(){f(l,l.SecondFactorAuthentication.IsOTPAuthenticatorVerified,l.SecondFactorAuthentication.IsGoogleAuthenticatorVerified)})})),w.util.addEvent("click",i,function(e){var o="phoneNo2FA="+l.SecondFactorAuthentication.OTPPhoneNo;T.resendOTPManually(o,u,c,p,d,m,g),T.verifyOTP=r||T.verifyOTP,T.resendOTP=s||T.resendOTP,T.verifyOTP(l,u,c,p,d,m,g),T.resendOTP(l,u,c,p,d,m,g)})},e=LoginRadiusDefaults.apiDomain+"/auth/login/2FA/";w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate;var o="post",n=window.lrbackupcode?(e=e+"backupcode?apiKey="+w.options.apiKey+"&"+t,o="get",""):(e=e+"?apiKey="+w.options.apiKey+"&loginUrl="+w.options.loginUrl+"&emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl+"&smsTemplate="+w.options.smsTemplateWelcome+"&smsTemplate2FA="+w.options.smsTemplate2FA,w.util.parseQueryString(t));w.util.ajaxCall(o,e,n,function(e){var o;w.options.stayLogin&&w.storage.setBrowserStorage("lr-rememberme",w.util.getQueryParameterByName("stayLogin",t)),e.ErrorCode?(w.options.phoneLogin&&"1066"==e.ErrorCode&&(o="phone="+w.util.getQueryParameterByName("phone",t),o+="&noPhoneVerified=false",w.options.optionalTwoFactorAuthentication=!1,w.options.twoFactorAuthentication=!1,T.verifyOTP=r||T.verifyOTP,T.resendOTP=s||T.resendOTP,T.verifyOTP(o,u,c,p,d,m,g),T.resendOTP(o,u,c,p,d,m,g)),p(T.loginRadiusErrorTojsError(e))):(e.SecondFactorAuthentication?(w.storage.setBrowserStorage(LoginRadiusDefaults.storedTwoFAToken,e.SecondFactorAuthentication.SecondFactorAuthenticationToken),w.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified),"00000000-0000-0000-0000-000000000000"===e.access_token&&f(e,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified,e.SecondFactorAuthentication.IsGoogleAuthenticatorVerified)):k.handleFeatures(e,t,g,m,c,p,d),w.lrApiFramework&&c(e))},"login")},k.resendOTPController=function(e,o,t,n,i,a){var r=e.updatePhone?w.options.smsTemplateUpdatePhone:w.options.smsTemplatePhoneVerification,s=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+w.options.apiKey+"&smsTemplate="+r,l="post";e.onetouchloginflag&&(l="get","string"!=typeof e&&(e=w.util.jsonToQueryString(e)),s=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+w.options.apiKey+"&"+e+"&smstemplate="+w.options.smsTemplatePhoneVerification),w.util.ajaxCall(l,s,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):(w.log(S.otpSent),o(e))},"resendOTP")},k.resendOTP2FAController=function(e,o,t,n,i,a){var r=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);s&&!w.LRCheckLogin?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+w.options.apiKey+"&access_token="+s+"&smsTemplate="+w.options.smsTemplate2FA,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):(w.log(S.otpSent),o(e))},"resendOTP"):r?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/resend?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&smsTemplate2FA="+w.options.smsTemplate2FA,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):w.log(S.otpSent)},"resendOTP"):t([T.setMappedMessage(S.twofaTokenValid)])},k.verify2FAOTPController=function(o,t,n,i,a){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),r=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);e&&!w.LRCheckLogin?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/Verification?apiKey="+w.options.apiKey+"&access_token="+e+"&"+o+"&smsTemplate="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"verifyOTP##twofaotp"):r?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/Verification?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&"+o+"&smsTemplate2FA="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):k.handleFeatures(e,o,a,i,t,n)},"verifyOTP##twofaotp"):n([T.setMappedMessage(S.twofaTokenValid)])},k.backupCodeController=function(o,t,n,i,a){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/backupcode?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&"+o+"&smsTemplate2FA="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):k.handleFeatures(e,o,a,i,t,n)},"login"):n([T.setMappedMessage(S.twofaTokenValid)])},k.checkPhoneNumberAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"checkPhone")},k.update2FAPhoneNumberController=function(o,t,n,i,a,r,s,l,u){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),c=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);c&&!w.LRCheckLogin?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+w.options.apiKey+"&access_token="+c+"&smsTemplate="+w.options.smsTemplate2FA,o,function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(T.verifyOTP=l||T.verifyOTP,T.resendOTP=u||T.resendOTP,T.verifyOTP(o,t,n,i,a,r,s),T.resendOTP(o,t,n,i,a,r,s),n(e,o))},"updatePhone"):e?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+w.options.smsTemplate2FA,o,function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(n(e,o),T.verifyOTP=l||T.verifyOTP,T.resendOTP=u||T.resendOTP,T.verifyOTP(o,t,n,i,a,r,s),T.resendOTP(o,t,n,i,a,r,s))},"login"):i([T.setMappedMessage(S.twofaTokenValid)])},k.updatePhoneNumberController=function(o,t,n,i,a,r,s,l,u){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);T.isValidToken(e,i)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+w.options.apiKey+"&access_token="+e+"&smsTemplate="+w.options.smsTemplateUpdatePhone,o,function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(T.verifyOTP=l||T.verifyOTP,T.resendOTP=u||T.resendOTP,T.verifyOTP(o+"&haveToken=true",t,n,i,a,r,s),T.resendOTP(o+"&updatePhone=true",t,n,i,a,r,s,!0),n(e,o))},"updatePhone")},k.resetPasswordByPhoneController=function(o,t,n,e,i){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"resetPassword")},k.resetPINByPhoneController=function(o,t,n,e,i){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/phone?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"resetPIN")},k.forgotPasswordbyPhoneController=function(o,t,n,i,a,r){w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateForgot,o,function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(n(e,o),(r||T.resetPassword)(t,n,i,a))},"forgotPassword")},k.forgotPINbyPhoneController=function(o,t,n,i,a,r){w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateForgot,o,function(e){e.ErrorCode?i(T.loginRadiusErrorTojsError(e)):(n(e,o),(r||T.resetPIN)(t,n,i,a))},"forgotPIN")},k.registrationController=function(n,i,a,r,s,e,l,u){w.LRCheckRegistration=!0;var o=n;w.lrApiFramework||(o=T.mapRegistrationSchema(e,n));var t="emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl+"&welcomeEmailTemplate="+w.options.welcomeEmailTemplate;w.options.phoneLogin&&(t+="&smsTemplate="+w.options.smsTemplatePhoneVerification),w.options.preventVerificationEmail&&(t+="&options=PreventVerificationEmail");var c="";w.options.invisibleRecaptcha||w.options.v2Recaptcha||w.options.tencentCaptcha?c=LoginRadiusDefaults.apiDomain+"/auth/register/captcha?apiKey="+w.options.apiKey+"&"+t:w.options.sott?(c=LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+w.options.apiKey+"&"+t,w.options.enableHeaderSott?(w.options.sott=decodeURIComponent(w.options.sott),o.sottcheck=!0):c+="&sott="+w.util.encodedString(w.options.sott)):w.options.vNextUX?w.log("SOTT commonOption is missing in configuration. You can use a static SOTT generated from Admin Console or create it at run-time using the API. For more details on SOTT generation, please refer to https://www.loginradius.com/docs/api/v2/customer-identity-api/sott-usage/."):w.log("url is not set as sott option is not defined"),""!==c&&w.util.ajaxCall("post",c,o,function(o){var t,e;o&&w.util.isObject(o)&&(o=w.util.keyslowerToUpperCamelCase(o)),o.ErrorCode?1049===o.ErrorCode?(w.options.vNextUX&&(S.invalidSott="An error occurred, please refresh the page to proceed with registration."),r([T.setMappedMessage(S.invalidSott)]),w.log(o.Description)):r(T.loginRadiusErrorTojsError(o)):(t=function(e){e.push({type:"button",name:"skip",display:"Skip",rules:"",permission:"r",event:"click",eventCallback:function(e){T.loginHandleToken(o,n,a,r)}})},w.options.phoneLogin&&("string"==typeof n||n instanceof String)&&-1!==n.indexOf("phoneid")?(-1===w.util.findInSchema(w.registrationFormSchema,"name","phoneid").rules.indexOf("required")&&w.$hooks.register("beforeFormRender",function(e,o){"otp"!==e||w.util.findInSchema(o,"name","skip")||t(o)}),T.verifyOTP=l||T.verifyOTP,T.resendOTP=u||T.resendOTP,T.verifyOTP(n,i,a,r,s),T.resendOTP(n,i,a,r,s)):(e=w.util.parseQueryString(n),w.options.disabledEmailVerification||w.options.optionalEmailVerification?(o.Data&&(delete(o=o.Data).Data,delete o.IsPosted),w.options.askRequiredFieldForTraditionalLogin=!1,w.options.disabledEmailVerification||!w.options.otpEmailVerification||w.options.verifyEmailByOTP?T.loginHandleToken(o,n,a,r):(w.$hooks.register("beforeFormRender",function(e,o){"otp"!==e||w.util.findInSchema(o,"name","skip")||t(o)}),T.otpEmailVerification(i,function(e){e.access_token||T.loginHandleToken(o,n,a,r)},r,s,e))):(a(o,e),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&T.otpEmailVerification(i,a,r,s,e))))},"registration")},k.periodicalPasswordRestController=function(e,o,t,n,i,a){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+w.options.apiKey+"&access_token="+i.access_token,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):T.loginHandleToken(i,a,o,t)},"periodicPassword")},k.changePasswordController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changePassword")},k.changePINController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/change?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changePIN")},k.resendEmailVerificationController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+w.options.apiKey+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resendVerificationEmail")},k.addEmailController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);T.isValidToken(e,n)&&w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&access_token="+e+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.addEmailTemplate,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):(t(e,w.util.parseQueryString(o)),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&T.otpEmailVerification(w.currentLRContainer,t,n,"",o))},"addEmail")},k.removeEmailController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);T.isValidToken(e,n)&&w.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&access_token="+e,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"removeEmail")},k.changeUsernameController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);T.isValidToken(e,n)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+w.options.apiKey+"&access_token="+e,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changeUsername")},k.resetPasswordController=function(o,t,n,e,i){o+="&welcomeEmailTemplate="+w.options.welcomeEmailTemplate+"&ResetPasswordEmailTemplate="+w.options.resetPasswordConfirmationEmailTemplate,w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/reset?apiKey="+w.options.apiKey,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resetPassword")},k.resetPINController=function(o,t,n,e,i){var a,r=w.util.parseQueryString(o),s="";s=r.hasOwnProperty("resettoken")?LoginRadiusDefaults.apiDomain+"/auth/pin/reset/token?apiKey="+w.options.apiKey:(a=r.hasOwnProperty("username")?"username":"email",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/"+a+"?apiKey="+w.options.apiKey),o+="&welcomeEmailTemplate="+w.options.welcomeEmailTemplate+"&ResetPINEmailTemplate="+w.options.resetPINConfirmationEmailTemplate,w.util.ajaxCall("put",s,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resetPIN")},k.emailVerificationController=function(e,o,t,n,i,a){var r,s,l,u="get";e?(r=LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&welcomeEmailTemplate="+w.options.welcomeEmailTemplate,s="",a?(u="put",s=e):r+="&verificationtoken="+e+"&url="+w.options.verificationUrl,l="##otp",w.options.verifyEmailByOTP&&(l=""),"##otp"===l&&(w.currentActionOptions||(w.currentActionOptions={}),w.currentActionOptions.otp={},w.currentActionOptions.otp.onSuccess=o||function(){},w.currentActionOptions.otp.onError=t||function(){},w.currentActionOptions.otp.classPrefix=i||""),w.util.ajaxCall(u,r,s,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):w.options.loginOnEmailVerification?null==e.Data?o(e):e.Data&&e.Data.access_token?T.loginHandleToken(e.Data,"",o,t):e.Data&&o(e):w.options.logoutOnVerifyEmail?T.logout(o(e)):o(e)},"verifyEmail"+l)):t(a?[S.notFound]:[S.vTokenError])},k.deleteUserConfirmController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/delete?apiKey="+w.options.apiKey+"&deletetoken="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"deleteUserConfirm"):t([S.vTokenError])},k.checkEmailAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"checkEmail")},k.checkUserNameAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"checkUsername")},k.resetPasswordBySecurityQuestionController=function(o,t,n){var e=T.sanitizeSecurityQuesData(o);w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/securityanswer/?apikey="+w.options.apiKey,e,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"resetPasswordBySecurityQuestion")},k.resetPINBySecurityQuestionController=function(o,t,n){var e=T.sanitizeSecurityQuesData(o),i=e.hasOwnProperty("email")?"email":e.hasOwnProperty("phone")?"phone":"username";w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/securityanswer/"+i+"?apikey="+w.options.apiKey,e,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e,o)},"resetPINBySecurityQuestion")},k.getSecurityQuestionsController=function(e,o,t){var n="/auth/securityquestion/";-1!==e.indexOf("username")?n+="username?apiKey=":-1!==e.indexOf("phone")?n+="phone?apiKey=":n+="email?apiKey=",w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+n+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(function(e){for(var o=[],t=0;t<e.length;t++){var n={};w.options.maskSensitiveInput?n.type="password":n.type="string",n.name=e[t].QuestionId,n.display=e[t].Question,n.rules="required",n.permission="r",o.push(n)}return o}(e))},"securityQuestion")},k.getBackupCodeController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"backupCode"):t([T.setMappedMessage(S.twofaTokenValid)])},k.resetBackupCodeController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode/reset?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"backupCode"):t([T.setMappedMessage(S.twofaTokenValid)])},k.getSocialDataController=function(e,o,t,n,i){e?(n+="?access_token="+e,i&&(n=n+"&"+i),w.util.ajaxCall("get",LoginRadiusDefaults.socialApiDomain+n,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"socialAPI")):t([T.setMappedMessage(S.twofaTokenValid)])},k.postSocialDataController=function(e,o,t,n,i,a){e?(n+="?access_token="+e,i&&(n=n+"&"+i),w.util.ajaxCall("post",LoginRadiusDefaults.socialApiDomain+n,a,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"socialAPI")):t([T.setMappedMessage(S.twofaTokenValid)])},k.createCustomObjectController=function(e,o,t,n){e?w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e)},"createCustomObject"):n([T.setMappedMessage(S.twofaTokenValid)])},k.getCustomObjectByIdController=function(e,o,t,n){i("get",e,o,t,n)},k.getCustomObjectsController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"getCustomObject"):t([T.setMappedMessage(S.twofaTokenValid)])},k.updateCustomObjectController=function(e,o,t,n,i,a){var r;e?(r=n?"&updatetype="+n:"",w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/customobject/"+o+"?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName+r,t,function(e){e.ErrorCode?a(T.loginRadiusErrorTojsError(e)):i(e)},"updateCustomObject")):a([T.setMappedMessage(S.twofaTokenValid)])},k.deleteCustomObjectController=function(e,o,t,n){i("delete",e,o,t,n)},k.updateData=function(e,c,p,d,m,g,f,o,t){var h=e.Profile||e.Data,y=p;w.lrApiFramework||(y=T.mapRegistrationSchema(f,p,h)),w.options.isPINAuthentication&&!w.options.PINConfiguration.AskOnRegistration&&(y=T.sanitizePinData(y));var v=e.access_token;t=t||w.setHostedToken,o=o||"updateData",w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,0<Object.keys(y).length?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+w.options.apiKey+"&access_token="+v+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate,y,function(u){u.ErrorCode?m(T.loginRadiusErrorTojsError(u)):function(e){var o=y.emailid||y.email,t=y.phone||y.phoneid,n=w.util.findInSchema(f,"name","phoneid"),i=n&&-1!==n.rules.indexOf("required"),a=w.util.findInSchema(f,"name","emailid"),r=a&&-1!==a.rules.indexOf("required");w.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,h.Uid);var s,l=w.util.parseQueryString(window.location.search.replace("?",""));(void 0===t||t)&&h.PhoneIdVerified&&void 0===o||(void 0===o||o)&&h.EmailVerified&&void 0===t||(t&&!i||void 0===t)&&(w.options.disabledEmailVerification||w.options.optionalEmailVerification)?o&&!h.EmailVerified&&l.return_url&&-1!==l.return_url.toLowerCase().indexOf("/saml/")?m([T.setMappedMessage(S.emailNotVerified)]):(delete u.IsPosted,u.access_token=v,e(),LoginRadiusDefaults.isSSOInitFired&&T.setToken(v)):t&&h&&!h.PhoneIdVerified?((s=new SetLoginRadiusCommonFunctions(w)).verifyOTP(p,c,d,m,g),s.resendOTP(p+"&noPhoneVerified=false",c,d,m,g)):!o||!r||h.EmailVerified||w.options.disabledEmailVerification||w.options.optionalEmailVerification?e():m([T.setMappedMessage(S.emailNotVerified)])}(t?function(){e.Data=e.Profile,delete e.Profile,u.Data&&(e.Data=u.Data),T.loginHandleToken(e,p,d,m)}:function(){u.Data&&(u.Profile=u.Data,delete u.Data,delete u.IsPosted),u.access_token?T.loginHandleToken(u,p,d,m):d(u,w.util.parseQueryString(p))})},o):T.loginHandleToken(e,p,d,m)},k.oneTouchLoginController=function(e,r,o,t,s,n){function i(t,e,n,o,i,a){T.createForm(w.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var o={};o.Profile=t,o.access_token=n,k.updateData(o,r,e,i,a,s,w.registrationFormSchema,"login",!0)},function(e){a(T.setMappedMessage(e))})}var a,l,u,c,p=w.util.checkPhoneOrEmailLogin(e),d=w.util.parseQueryString(p),m=n?"POST":"GET",g="";d.phone?(a=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+w.options.apiKey+"&smstemplate="+w.options.smsTemplateOneTouchLogin,n?g=Object.assign({},d):a=a+"&"+p,w.util.ajaxCall(m,a,g,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):(T.verifyOTP(p+"&onetouchloginflag=true",r,o,t,s,"",i),T.resendOTP(p+"&onetouchloginflag=true",r,o,t,s,"",i))},"oneTouchLogin")):(l=w.util.randomString(16),u=w.options.noRegistrationEmailTemplate||w.options.onetouchLoginEmailTemplate,c=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/email?apikey="+w.options.apiKey+"&onetouchloginemailtemplate="+u+"&welcomeemailtemplate="+w.options.welcomeEmailTemplate+"&redirectUrl="+w.options.onetouchLoginRedirectUrl,n?g=Object.assign({},d,{clientGuid:l}):c=c+"&"+p+"&clientGuid="+l,w.util.ajaxCall(m,c,g,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):e.IsPosted&&(o(e),T.pingForSmartLogin(l,function(e){w.options.askRequiredFieldsOnPasswordLessLogin?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,k.handleFeatures(e,p,i,"",o,t)):T.loginHandleToken(e,"",o,t,"",!0)},t))},"oneTouchLogin"))},k.smartLoginController=function(e,o,t){var n=w.util.randomString(16),i=w.options.autoLoginRedirectUrl||w.options.smartLoginRedirectUrl,a=w.options.autoLoginEmailTemplate||w.options.smartLoginEmailTemplate;w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin?apikey="+w.options.apiKey+"&"+e+"&clientGuid="+n+"&smartloginemailtemplate="+a+"&welcomeemailtemplate="+w.options.welcomeEmailTemplate+"&redirectUrl="+i,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):e.IsPosted&&(o(e),T.pingForSmartLogin(n,function(e){T.loginHandleToken(e,"",o,t)},t))},"smartLogin")},k.verifyInstantOTP=function(o,e,t,n,i,a,r){var s="phone="+e.phone+"&"+o;w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp/verify?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,s,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):T.loginHandleToken(e,o,t,n)},"login##otp")},k.socialLoginReceiveToken=function(d,m,g,f,h,y,e,o){w.currentLRContainer=m,w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,w.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,d);var v,C;function t(e){var o,t,n,i,a,r,s,l,u,c,p;w.LRCheckLogin=!0,e.IsDeleted?f([T.setMappedMessage(S.blockedUser)]):((o={}).Profile=e,o.access_token=d,T.setPasswordRule(w.util.findInSchema(C,"name","password")),T.setPasswordRule(w.util.findInSchema(C,"name","confirmpassword")),t=!1,w.options.autoFilledFieldForSocial&&(t=!0,w.$hooks.register("beforeFormRender",function(e,o){var t,n;"socialRegistration"===e&&((t=w.util.findInSchema(o,"name","emailid"))&&t.value&&(t.disabled=!0),(n=w.util.findInSchema(o,"name","phoneid"))&&n.value&&(n.disabled=!0))})),w.registrationFormSchema=T.mapSchema(C,e,t),w.$hooks.call("registrationSchemaFilter",C,e),n=w.storage.getBrowserStorage("LRTraditionalLogin"),w.storage.removeBrowserStorage("LRTraditionalLogin"),0<w.registrationFormSchema.length&&!n?m?(w.$hooks.call("socialLoginFormRender"),T.createForm(w.registrationFormSchema,"socialRegistration",m,function(e){k.updateData(o,m,e,g,f,h,w.registrationFormSchema,"socialLogin")},function(e){f(e)},h)):y(d,w.registrationFormSchema,e):(r=(a=(i=w.util.findInSchema(v,"name","phoneid"))&&-1!==i.rules.indexOf("required"))?!!e.PhoneIdVerified:e.PhoneIdVerified,u=(l=(s=w.util.findInSchema(v,"name","emailid"))&&-1!==s.rules.indexOf("required"))?!!e.EmailVerified:e.EmailVerified,(!r&&a||!u&&l)&&(!r&&a||!w.options.disabledEmailVerification&&!w.options.optionalEmailVerification)?null==e.Email||e.EmailVerified?(c={phone:e.PhoneId},f([T.setMappedMessage(S.phoneNotVerified)],c),p=h+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp",k.resendOTPController(c,function(){w.socialLoginFlag=!0,T.verifyOTP("phone="+e.PhoneId,m,g,f,h),T.resendOTP("phone="+e.PhoneId+"&noPhoneVerified=false",m,g,f,h)},f,p,m,h)):f([T.setMappedMessage(S.emailNotVerified)]):(w.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,e.Uid),LoginRadiusDefaults.isSSOInitFired&&T.setToken(d),T.loginHandleToken(o,"",g,f))))}e=e&&0<e.length?e:w.options.RegistrationFormSchema,v=e,C=JSON.parse(JSON.stringify(v)),o?t(o):w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+w.options.apiKey+"&access_token="+d+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate+"&welcomeEmailTemplate="+w.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?f(T.loginRadiusErrorTojsError(e)):t(e)},"socialLogin")},k.accountLinkingReceiveToken=function(o,t,n){w.options.noCallbackForSocialLogin?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+w.options.apiKey+"&access_token="+o,"",function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):e.Uid!==w.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e)},"linkAccount"):t({IsPosted:!0})},"linkAccount"):w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):t(e)},"linkAccount")},k.validateToken=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/Validate?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"validateToken"):t([T.setMappedMessage(S.twofaTokenValid)])},k.invalidateToken=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/InValidate?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"invalidateToken"):t([T.setMappedMessage(S.twofaTokenValid)])},k.updatePrivacyPolicy=function(t,n,i,a,r,s,l){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/privacypolicy/accept?apikey="+w.options.apiKey+"&access_token="+t,"",function(e){var o;e.ErrorCode?a(T.loginRadiusErrorTojsError(e)):(r?o=e:((o=n.Data||{}).access_token=t,o.Profile=e,o.Profile=Object.assign({},o.Profile,{IsLatestPrivacyPolicy:!0})),o.Profile&&("email"===o.Profile.RegistrationProvider.toLowerCase()?T.loginHandleToken(o,"",i,a):k.socialLoginReceiveToken(t,s,i,a,l)))},"updatePrivacyPolicy")},k.configurePINController=function(e,o,t,n,i,a){w.util.ajaxCall("POST",LoginRadiusDefaults.apiDomain+"/auth/pin/set/pinauthtoken?apikey="+w.options.apiKey+"&pinauthtoken="+e,o,function(e){e&&e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?T.loginHandleToken(e,"",t,n):k.socialLoginReceiveToken(e.access_token,i,t,n,a))},"pinSetup")},k.pinReauthController=function(e,o,t,n){var i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/reauth/pin?apiKey="+w.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"pinreauthentication")},k.customEventConsentController=function(e,o,t,n){var i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/profile?apiKey="+w.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"customeventconsent")},k.submitConsentController=function(e,o,t,n,r,s,i){e&&(i=i||"submitconsent",w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+w.options.apiKey+"&consenttoken="+e,o,function(e){e.ErrorCode?n(T.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?k.handleFeatures(e,"",function(t,e,n,o,i,a){T.createForm(w.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var o={};o.Profile=t,o.access_token=n,k.updateData(o,r,e,i,a,s,w.registrationFormSchema,"login",!0)},function(e){a(T.setMappedMessage(e))})},"",t,n,s):k.socialLoginReceiveToken(e.access_token,r,t,n,s,"","",e.Profile))},i))},k.verifyConsentController=function(e,o,t){var n=!!e.isCustom&&e.isCustom,i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/verify?apiKey="+w.options.apiKey+"&access_token="+i+"&event="+e.event+"&isCustom="+n,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"verifyconsent")},k.consentLogsController=function(o,t){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e&&w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/logs?apiKey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"cosentlogs")},k.updateConsentController=function(e,o,t){var n=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+w.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?t(T.loginRadiusErrorTojsError(e)):o(e)},"updateconsent")}}var LoginRadiusV2=function(t){this.global=window;var h=this,y=new SetLoginRadiusCommonFunctions(h),v=new LoginRadiusControllers(h,y),s=LoginRadiusDefaults.buttonNames,C=LoginRadiusDefaults.messages,p=LoginRadiusDefaults._uuidFormat,e=hash.get("lr-token");try{e&&window.opener&&window.opener.html5passToken&&(window.opener.html5passToken(e),document.write("<style type='text/css'>body { display: none !important; } </style>"),hash.remove("lr-token"),window.close())}catch(e){}var o=new LRNameSpace.Utilities;h.util=new LoginRadiusUtility(h,t),h.storage=new LRNameSpace.Storage(h,LoginRadiusDefaults);var w=h.util=Object.assign(o,h.util,h.storage);function T(e,o,t,n){e&&w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email/verify?apiKey="+h.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+h.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?t(y.loginRadiusErrorTojsError(e)):y.loginHandleToken(e,"",o,t,n)},"passwordlessLogin")}function a(r,i,a,s){function o(e,t){y.createForm(e,t,r,function(n){var e,o;h.LRCheckLogin=!0,window.lrpasswordlesslogin?y.sendInstantSignInLink(n,i,a,r,s):window.lrpasswordlessloginotp?y.sendInstantSignInOtp(n,i,a,r,s):(e=function(t,e,n,o,i,a){y.createForm(h.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var o={};o.Profile=t,o.access_token=n,v.updateData(o,r,e,i,a,s,h.registrationFormSchema,"login",!0)},function(e){a(y.setMappedMessage(e))})},o=function(o,t){y.createForm(h.changePasswordFormSchema,"changepassword",r,function(e){v.periodicalPasswordRestController(e,i,a,o,t,n)},function(e){a(e)})},h.options.twoFactorAuthentication||h.options.optionalTwoFactorAuthentication?v.login2FAController(n,r,i,a,s,o,e):"pinLogin"===t?v.loginPINController(n,r,i,a,s,o,e,c):v.loginController(n,r,i,a,o,e,s))},function(e){a(y.setMappedMessage(e))},s)}var t,e,n,l=w.getHashParam("vtoken"),u=w.getHashParam("vtype"),c=h.getSessionToken();h.currentLRContainer=r,"oneclicksignin"!==u&&"passwordlesslogin"!==u||h.passwordlessLoginFlag||(h.passwordlessLoginFlag=!0,T(l,i,a,s)),t=h.loginFormSchema,h.loginAction=!0,P(t),t=JSON.parse(JSON.stringify(function(e){if(h.options.stayLogin){for(var o=!0,t=0;t<e.length;t++)"stayLogin"===e[t].name&&(o=!1);o&&e.push({type:"multi",name:"stayLogin",display:"Remember me",rules:null,permission:"w"})}return e}(t))),y.setPasswordRule(t[1],h.loginAction),!h.passwordlessLoginFlag&&!h.options.twoFactorAuthentication&&!h.options.optionalTwoFactorAuthentication&&h.options.isPINAuthentication&&h.options.PINConfiguration&&h.options.PINConfiguration.PINLogin&&c?(e=h.pinLoginFormSchema.slice(),n=Object.assign({},h.defaultBtnSchema,{name:"backtologinform",display:LoginRadiusDefaults.buttonNames.pinloginbackbtn,eventCallback:function(e){o(t,"login")}}),e.push(n),h.loginAction=!0,t.rules="required",o(e,"pinLogin")):o(t,"login")}function S(n,i,a,r,s){h.$hooks.call("registrationSchemaFilter",s);var e,l=r+LoginRadiusDefaults.idPrefix+"recaptcha_widget_registration";if(h.options.isConsentManagementEnabled||w.captchaSchema(l,s),h.options.privacyPolicyConfiguration.IsEnabled&&((e=h.privacyPolicySchema.slice())[0].rules="Strict"===h.options.privacyPolicyConfiguration.Mode?"required":"",s.push(e[0])),h.options.isPINAuthentication&&h.options.PINConfiguration.AskOnRegistration)y.setPINRule(w.findInSchema(s,"name","pin")),y.setPINRule(w.findInSchema(s,"name","confirmpin"));else{for(var o=[],t=0;t<s.length;t++)"pin"!==s[t].name&&"confirmpin"!==s[t].name&&o.push(s[t]);s=o}s.push({type:"html",name:"termsandcondition",html:h.options.termsAndConditionHtml||""}),y.setPasswordRule(w.findInSchema(s,"name","password")),y.setPasswordRule(w.findInSchema(s,"name","confirmpassword")),h.registrationFormSchema=s,h.options.isConsentManagementEnabled?h.getConsentConfiguration(function(e){var o,t=y.createConsentInterface(e.Register);""!==t&&(o={html:t,name:"consent",type:"html"},s.push(o)),w.captchaSchema(l,s),u(s,n,i,a,l,r,!0),w.renderV2Recaptcha(l,!0)}):(u(s,n,i,a,l,r,!1),w.renderV2Recaptcha(l,!0))}function u(t,n,i,a,r,s,l){y.createForm(t,"registration",n,function(e){var o=[];l&&(o=y.consentValidation(e,"Register")),0<o.length?a(o):v.registrationController(e,n,function(e,o){window.grecaptcha&&h.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),i(e,o)},function(e){window.grecaptcha&&h.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s,t)},function(e){window.grecaptcha&&h.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s)}function r(n,i,a,r){function o(e){var o=w.getHashParam("vtoken");if(h.options.verifyEmailByOTP){var t={};e&&(t=w.mergeOptions(t,w.parseQueryString(e))),t.otp=o;try{t.email=w.getQueryParameterByName("email").replace(/ /g,"+"),v.emailVerificationController(t,n,i,a,r,!0)}catch(e){h.log(e)}}else v.emailVerificationController(o,n,i,a,r)}a&&"Captcha"===h.options.loginLockedType&&(h.$hooks.register("afterFormRender",function(e,o,t,n){n&&"loginradius-verifyemail"===n.name&&"loginradius-submit-verify"===n[0].id&&(n[0].style.display="none")}),y.createForm([],"verifyemail",a,function(e){o(e)},function(e){i(e)},r)),o()}function k(t,n,i,e){var o=document.createElement("input");o.setAttribute("type","button");var a=h.buttonsName["createTwoFactorAuthentication".toLowerCase()]||s.createtwofactorauthentication;o.setAttribute("value",a);var r=e||LoginRadiusDefaults.classPrefix;document.getElementsByName(r+"profileeditor")[0]?h.options.showTwoFactorOnProfile&&document.getElementsByName(r+"profileeditor")[0].appendChild(o):(h.options.twoFactorAuthentication||h.options.optionalTwoFactorAuthentication)&&w.addHTMLContent(t,o),w.addEvent("click",o,function(e){h.options.optionalTwoFactorAuthentication||h.options.twoFactorAuthentication?w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+h.options.apiKey+"&access_token="+h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){var o;h.LRCheck2FA=!0,h.LRCheckLogin=!1,e.ErrorCode?i(y.loginRadiusErrorTojsError(e)):(h.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.IsOTPAuthenticatorVerified),h.storage.setBrowserStorage(LoginRadiusDefaults.storedGAAuth,e.IsGoogleAuthenticatorVerified),o=e.IsOTPAuthenticatorVerified,h.options.googleAuthentication&&(y.showQRCode(e,t,n,i,r),LoginRadiusDefaults.innerHTML=!0),o?y.changeNumberForm(t,"",n,i,r,LoginRadiusDefaults.innerHTML):y.updatePhoneNumber(t,n,i,r,"updatePhone2FA"))},"createTwoFactorAuthentication"):h.log("Two Factor Authentication will not work, please set in commonOpitons either twoFactorAuthentication or optionalTwoFactorAuthentication"),e.target.parentNode&&e.target.parentNode.removeChild(e.target)})}function L(e,o){var t=[];if(h.options.SecurityQuestions){function n(e){var o=new RegExp("securityQuestion"),t=e.target.id.split("securityQuestion")[1];r[t]=e.target.selectedIndex;for(var n=w.findElementByRegex("id",o,"select"),i=0;i<n.length;i++)for(var a=1;a<n[i].options.length;a++)-1<r.indexOf(n[i].options[a].index)&&n[i].options[a].index!==n[i].options.selectedIndex?n[i].options[a].style.display="none":n[i].options[a].style.display="block"}for(var i=[],r=[],a=0;a<h.options.SecurityQuestions.length;a++){var s={};s.text=h.options.SecurityQuestions[a].Question,s.value=h.options.SecurityQuestions[a].QuestionId,i.push(s),r.push(0)}for(var l=0;l<h.options.securityQuestionsCount;l++){var u={type:"option"};u.options=i,u.name="securityQuestion"+l,u.display="Security Question",u.event="change",u.eventCallback=n,u.rules=o?"optional":"required",u.permission="r",o?e.push(u):t.push(u);var c={};h.options.maskSensitiveInput?c.type="password":c.type="string",c.name="securityAnswer"+l,c.display="Answer",c.rules=o?"optional":"required",c.permission="r",o?e.push(c):t.push(c)}}return t}function P(e){var o,t;h.options.duplicateEmailWithUniqueUsername?((o=w.findInSchema(e,"name","emailid")).display="Username",o.rules="required"):(h.options.usernameLogin&&-1===(t=w.findInSchema(e,"name","emailid")).display.indexOf("/Username")&&(t.display=t.display+"/Username",t.rules="required"),(h.options.phoneLogin||h.options.passwordlessLoginOTP)&&(t||((t=w.findInSchema(e,"name","emailid")).rules="required"),-1===t.display.indexOf("/Phone")&&(t.display=t.display+"/Phone")))}function l(o,t,n,i){var e,a,r,s=w.getHashParam("vtoken"),l=w.getHashParam("vtype"),u=!1;h.options.v2Recaptcha||h.options.invisibleRecaptcha||h.options.tencentCaptcha||h.options.tencentCaptchaAsFallback?u=!0:h.options.privacyPolicyConfiguration.IsEnabled&&h.log("Captcha should be enabled for passwordless login if using with privacy policy"),"noregistration"!==l&&"onetouchlogin"!==l||(a=t,r=n,(e=s)&&w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email/autologin?apiKey="+h.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+h.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?r(y.loginRadiusErrorTojsError(e)):y.loginHandleToken(e,"",a,r)},"smartlogin"));var c,p,d=h.passwordLessLoginSchema;h.options.phoneLogin&&((c=w.findInSchema(d,"name","emailid")).display=c.display+"/Phone"),u&&(w.addRecaptchaJS(),p=i+LoginRadiusDefaults.idPrefix+o,w.captchaSchema(p,d)),y.createForm(d,"oneTouchLogin",o,function(e){v.oneTouchLoginController(e,o,t,n,i,u)},function(e){n(e)},i),u&&w.renderV2Recaptcha(p,!0)}function R(a,r,s,l){var e=h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e?w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+h.options.apiKey+"&access_token="+e,"",function(o){h.getConsentConfiguration(function(e){!function(e){var o,t=[],n="";e&&e.ConsentProfile&&e.ConsentProfile.Consents&&(o=e.ConsentProfile.Consents,n=y.createConsentOptionInterface(h.consentsList,o));var i={html:n,name:"consent",type:"html"};t.push(i),y.createForm(t,"consenteditor",a,function(e){var o=y.consentValidation(e);if(0<o.length)s(o);else{var t,n=h.util.parseQueryString(e),i=[];for(t in n){var a=t.replace("consent_","");i.push({ConsentOptionId:a,IsAccepted:n[t]})}(n={}).Consents=i,v.updateConsentController(n,r,s)}},function(e){s(e)},l)}(o)})}):s([y.setMappedMessage(C.tokenValid)])}function n(i,u){var d=(u=u||{}).onSuccess||function(){},m=u.onError||function(){},g=u.container||"",f=u.classPrefix||"",c=u.templateName||"";h.$hooks.register("getCurrentActionOptions",function(e){i==e&&(window.LRSafarionSuccess=d||function(){},window.LRSafarionError=m||function(){}),h.currentActionOptions||(h.currentActionOptions={}),h.currentActionOptions[i]={},h.currentActionOptions[i].onSuccess=d||function(){},h.currentActionOptions[i].onError=m||function(){},h.currentActionOptions[i].container=g,h.currentActionOptions[i].classPrefix=f||"",h.currentActionOptions[i].templateName=c||""}),h.getAppConfiguration(function(){"registration"!==i&&"updateSecurityQuestion"!==i&&h.$hooks.call("beforeInit",i);var e={};e.privacyPolicyUpdate=function(){var o,t,n,i,a,e;o=g,t=d,n=m,i=f,h.options.privacyPolicyConfiguration.IsEnabled&&((a=h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?((e=h.privacyPolicySchema.slice())[0].rules="Strict"===h.options.privacyPolicyConfiguration.Mode?"required":"",y.createForm(e,"privacyPolicyUpdate",o,function(e){v.updatePrivacyPolicy(a,"",t,n,!0,o,i)},function(e){n(y.setMappedMessage(e))})):n([y.setMappedMessage(C.tokenValid)]))},e.login=function(){a(g,d,m,f)},e.registration=function(){var e=setInterval(function(){var r,s,l,u;LoginRadiusDefaults.isRegFormSchemaLock||(LoginRadiusDefaults.isRegFormSchemaLock=!0,h.$hooks.call("beforeInit",i),r=g,s=d,l=m,u=f,w.addRecaptchaJS(),h.registrationFormSchema=h.registrationFormSchema&&0<h.registrationFormSchema.length?h.registrationFormSchema:h.options.RegistrationFormSchema,function(e){for(var o,t,n=JSON.parse(JSON.stringify(e)),i=[],a=0;a<n.length;a++){n[a]&&h.options.showSplitForm&&n[a].DataSource&&null!==n[a].DataSource&&(o=JSON.parse(JSON.stringify(n[a])),t=JSON.parse(JSON.stringify(w.findInSchema(n,"name","cf_"+n[a].DataSource+"Code"))),o.name="recordid",t.name="code",i.push(o),i.push(t))}0<i.length&&h.options.showSplitForm?y.createForm(i,"validatecode",r,function(e){w.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/validatecode?apiKey="+h.options.apiKey,e,function(e){1==e.IsValid?S(r,s,l,u,n):l(e)},"registration")}):(h.options.securityQuestionEnabled&&h.options.SecurityQuestions&&L(n,!0),S(r,s,l,u,n))}(h.registrationFormSchema),clearInterval(e))},1e3)},e.resetPassword=function(){y.resetPassword(g,d,m,f)},e.resetPIN=function(){y.resetPIN(g,d,m,f)},e.forgotPassword=function(){var o,t,n,i,e;o=g,t=d,n=m,i=f,P(e=h.forgotPasswordFormSchema),y.createForm(e,"forgotpassword",o,function(e){-1!==(e=w.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,v.forgotPasswordbyPhoneController(e,o,t,n,i)):v.forgotPasswordController(e,o,t,n,i)},function(e){n(e)},i)},e.forgotPIN=function(){var o,t,n,i,e;o=g,t=d,n=m,i=f,P(e=h.forgotPINFormSchema),y.createForm(e,"forgotPIN",o,function(e){-1!==(e=w.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,v.forgotPINbyPhoneController(e,o,t,n,i)):v.forgotPINController(e,o,t,n,i)},function(e){n(e)},i)},e.verifyEmail=function(){r(d,m,g,f)},e.changePassword=function(){var e,o,t,n,i;e=g,o=d,t=m,n=f,i=h.changePasswordFormSchema,y.setPasswordRule(w.findInSchema(i,"name","newpassword")),y.setPasswordRule(w.findInSchema(i,"name","confirmnewpassword")),y.createForm(i,"changepassword",e,function(e){v.changePasswordController(e,o,t)},function(e){t(e)},n)},e.changePIN=function(){var e,o,t,n,i;e=g,o=d,t=m,n=f,i=h.changePINFormSchema.slice(),y.setPINRule(w.findInSchema(i,"name","newpin")),y.setPINRule(w.findInSchema(i,"name","confirmnewpin")),y.createForm(i,"changepin",e,function(e){v.changePINController(e,o,t)},function(e){t(e)},n)},e.crossDeviceSSO=function(){y.loadQRCodeScript(function(){var e,o,t,n,i,a;e=g,o=u.expirytime,t=d,n=m,i=f,h.options.isCrossDeviceSSOEnabled&&(a=setInterval(function(){h.CDSSOPingApiTimeout&&clearTimeout(h.CDSSOPingApiTimeout),y.generateCrossDeviceSSOCode(e,o,t,n,i,function(){clearInterval(a)})},1e3*o),y.generateCrossDeviceSSOCode(e,o,t,n,i,function(){clearInterval(a)}))})},e.socialLogin=function(){var e=w.elementById(g);e&&w.addEvent("click",e,function(){LoginRadiusDefaults.socialRegFormId=this.id}),LoginRadiusDefaults.socialRegFormId=g,y.socialLogin(g,d,m,f)},e.linkAccount=function(){var i,a,r,s,l,e;i=g,a=d,r=m,s=c,h.options.disableAccountLinking?h.log(C.disabledAccountLinking):(l=i.split(","),(e=h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+h.options.apiKey+"&access_token="+e,"",function(e){if(e.ErrorCode)r(y.loginRadiusErrorTojsError(e));else if(e.EmailVerified||e.PhoneIdVerified){var o={};if(e.Identities)for(var t=0,n=e.Identities.length;t<n;t++)o[e.Identities[t].Provider]=e.Identities[t].ID;1===l.length?y.renderCustomInterface(i,o,s,"",!0):y.renderCustomInterface(i,o,h.options.linkedAccountsTemplate+","+h.options.notLinkedAccountsTemplate,!0,!0),window.html5passToken=function(e){v.accountLinkingReceiveToken(e,a,r)},h.options.isMobile||h.options.noCallbackForSocialLogin?h.$hooks.register("socialCalls",function(e,o){h.options.noCallbackForSocialLogin&&y.pingForSmartLogin(o,function(e){e.access_token?v.accountLinkingReceiveToken(e.access_token,a,r):a(e)},function(){})}):w.addEvent("message",window,function(e){-1===e.origin.indexOf(h.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||"string"==typeof e.data&&p.test(e.data)&&v.accountLinkingReceiveToken(e.data,a,r)})}else r([y.setMappedMessage(C.unverifiedUser)])},"linkAccount"):r([y.setMappedMessage(C.tokenValid)]))},e.unLinkAccount=function(){var t=w.unLinkAccount;w.unLinkAccount=function(e,o){t(e,o,d,m)}},e.profileEditor=function(){var s,l,u,c,a,p;s=g,l=d,u=m,c=f,(p=h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?(a=function(r){w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+h.options.apiKey+"&access_token="+p,"",function(e){var o=JSON.parse(JSON.stringify(r)),o=y.mapSchema(o,e,"profileeditor"),t=[],n=[],i={};i.Profile=e,i.access_token=p;for(var a=0;a<o.length;a++)o[a].name&&-1===o[a].name.indexOf("emailid")&&-1===o[a].name.indexOf("phoneid")&&t.push(o[a]),o[a].permission&&"h"!==o[a].permission&&n.push(o[a]);y.createForm(t,"profileeditor",s,function(e){v.updateData(i,s,e,l,u,c,t,"profileEditor")},function(e){u(e)},c),(h.options.optionalTwoFactorAuthentication||h.options.twoFactorAuthentication)&&k(s,l,u,c),h.$hooks.call("renderProfileEditorHook",e,n)},"profileEditor")},h.registrationFormSchema=h.registrationFormSchema&&0<h.registrationFormSchema.length?h.registrationFormSchema:h.options.RegistrationFormSchema,h.progressiveProfiling.showInEditor?h.progressiveProfiling.fetchSchema(function(e){var o=h.registrationFormSchema.slice();if(e&&e.ProfilingSteps)for(var t=0;t<e.ProfilingSteps.length;t++)for(var n=e.ProfilingSteps[t].Schema,i=0;i<n.length;i++){h.util.containsObject(o,n[i],"name")||o.push(n[i])}a(o)}):a(h.registrationFormSchema)):u([y.setMappedMessage(C.tokenValid)])},e.deleteUser=function(){var o,t,e;o=d,t=m,(e=h.sessionData.getToken())?w.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+h.options.apiKey+"&access_token="+e+"&deleteUrl="+h.options.deleteUrl+"&emailTemplate="+h.options.deleteUserEmailTemplate,{},function(e){e.ErrorCode?t(y.loginRadiusErrorTojsError(e)):o(e)},"deleteUser"):t([C.vTokenError])},e.deleteUserConfirm=function(){var e,o,t;e=d,o=m,t=w.getHashParam("vtoken"),v.deleteUserConfirmController(t,e,o)},e.updatePhone=function(){h.LRCheck2FA=!1,y.updatePhoneNumber(g,d,m,f)},e.changeUsername=function(){var e,o,t,n;e=g,o=d,t=m,n=f,y.createForm(h.changeUsernameFormSchema,"changeUsername",e,function(e){v.changeUsernameController(e,o,t)},function(e){t(e)},n)},e.resendVerificationEmail=function(){var e,o,t,n;e=g,o=d,t=m,n=f,y.createForm(h.emailSchema,"resendEmailVerification",e,function(e){v.resendEmailVerificationController(e,o,t)},function(e){t(e)},n)},e.addEmail=function(){var e,o,t,n;e=g,o=d,t=m,n=f,y.createForm(h.addEmailSchema,"addemail",e,function(e){v.addEmailController(e,o,t)},function(e){t(e)},n)},e.removeEmail=function(){var e,o,t,n;e=g,o=d,t=m,n=f,y.createForm(h.emailSchema,"removeemail",e,function(e){v.removeEmailController(e,o,t)},function(e){t(e)},n)},e.createTwoFactorAuthentication=function(){k(g,d,m,f)},e.backupCodeButton=function(){var t,n,i,a;t=g,n=d,i=m,a=f,w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+h.options.apiKey+"&access_token="+h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){var o;(e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified)&&(o=h.util.getButtonAttribute("generatebackupcodebutton",a),w.addHTMLContent(t,o),w.addEvent("click",o,function(e){h.api.getBackupCode(h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),n,i)}))})},e.resetBackupCodeButton=function(){var n,i,a;n=g,i=d,a=m,w.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+h.options.apiKey+"&access_token="+h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){var o,t;(e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified)&&((o=document.createElement("input")).setAttribute("type","button"),t=h.buttonsName["resetBackupCode".toLowerCase()]||s.resetBackupCode,o.setAttribute("value",t),w.addHTMLContent(n,o),w.addEvent("click",o,function(e){h.api.resetBackupCode(h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i,a)}))})},e.updateSecurityQuestion=function(){var s=setInterval(function(){var e,o,t,n,i,a,r;LoginRadiusDefaults.isSecurityFormSchemaLock||(LoginRadiusDefaults.isSecurityFormSchemaLock=!0,e=g,o=d,t=m,n=f,h.options.securityQuestionEnabled&&(h.registrationFormSchema=h.registrationFormSchema&&0<h.registrationFormSchema.length?h.registrationFormSchema:h.options.RegistrationFormSchema,i=h.registrationFormSchema,a=!0,0<(r=L(i)).length&&(a=!1),a?t([y.setMappedMessage(C.noSecurityQuestions)]):y.createForm(r,"updatesecurityquestion",e,function(e){v.updateSecurityQuestionController(e,o,t)},function(e){t(e)},n)),clearInterval(s))},1e3)},e.resetPasswordBySecurityQuestion=function(){var n,i,a,r,s,e;n=g,i=d,a=m,r=f,h.options.securityQuestionEnabled&&(s=!0,P(e=h.getSecQSchema),y.createForm(e,"securityquestions",n,function(e){e=w.checkPhoneOrEmailLogin(e),v.getSecurityQuestionsController(e,function(e){0<e.length&&(s=!1);var o=h.loginFormSchema.slice();y.setPasswordRule(h.util.findInSchema(o,"name","password")),y.setPasswordRule(h.util.findInSchema(o,"name","confirmpassword"));var t=w.mergeObjects(o,e);h.loginAction||P(t),s?a([y.setMappedMessage(C.noSecurityQuestions)]):y.createForm(t,"resetpwdbysecq",n,function(e){e=w.checkPhoneOrEmailLogin(e),v.resetPasswordBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r))},e.resetPINBySecurityQuestion=function(){var n,i,a,r,s,e;n=g,i=d,a=m,r=f,h.options.securityQuestionEnabled&&(s=!0,P(e=h.getSecQSchema),y.createForm(e,"securityquestions",n,function(e){e=w.checkPhoneOrEmailLogin(e),v.getSecurityQuestionsController(e,function(e){0<e.length&&(s=!1);var o=h.resetPINFormSchema.slice(0,1);o.push(h.loginFormSchema[0]),y.setPINRule(h.util.findInSchema(o,"name","pin"));var t=w.mergeObjects(o,e);h.loginAction||P(t),s?a([y.setMappedMessage(C.noSecurityQuestions)]):y.createForm(t,"resetpinbysecq",n,function(e){e=w.checkPhoneOrEmailLogin(e),v.resetPINBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r))},e.ssoLogin=function(){var t;t=d,y.validateAndCall(function(){var e=h.options.customDomain||h.options.appName+"."+LoginRadiusDefaults.hubDomain;w.ajaxCall("get","https://"+e+"/ssologin/login","",function(o){o.isauthenticated&&(h.loginRadiusHtml5PassToken?h.loginRadiusHtml5PassToken(o.token):(h.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,o.token),h.options.tokenType&&"jwt"===h.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},y.getJwtToken(o.token,function(e){t(o.token,e)})):t(o.token)))})})},e.logout=function(){y.logout(d)},e.ssoNotLoginThenLogout=function(){var t,n;t=m,n=d,y.validateAndCall(function(){var e=h.options.customDomain||h.options.appName+"."+LoginRadiusDefaults.hubDomain;w.ajaxCall("get","https://"+e+"/ssologin/login","",function(o){var e;o.isauthenticated?(void 0!==(e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie))&&null!=e||(y.setToken(o.token),e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie)),e&&e!==o.token?(y.setToken(o.token),n(o.token)):(h.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,o.token),h.options.tokenType&&"jwt"===h.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},y.getJwtToken(o.token,function(e){n(o.token,e)})):n(o.token))):(LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,h.options.appPath),t())})})},e.pinreauthentication=function(){var e,o,t,n,i;e=g,o=d,t=m,n=f,i=[],h.pinLoginFormSchema&&((i=h.pinLoginFormSchema.slice()).rules="required"),i.length?y.createForm(i,"pinreauthentication",e,function(e){v.pinReauthController(e,o,t)},function(e){t(e)},n):h.log("Pin schema is not defined")},e.customeventconsent=function(){var i,a,r,s,l;i=g,a=u.event,r=d,s=m,l=f,h.getConsentConfiguration(function(e){var o,t=[],n=y.createConsentInterface(e["custom_"+a]);""!==n&&(o={html:n,name:"consent",type:"html"},t.push(o),y.createForm(t,"customeventconsent",i,function(e){var o,t,n=y.consentValidation(e,"custom_"+a);0<n.length?s(n):(o=[],t=y.mapRegistrationSchema(null,e).Consents,o.push({Event:a,IsCustom:!0}),t.Events=o,v.customEventConsentController(t,r,s))},function(e){s(e)},l))})},e.consenteditor=function(){R(g,d,m,f)};function o(){var e,o,t,n,i;e=d,o=m,t=f,n=w.getHashParam("vtoken"),"oneclicksignin"!==(i=w.getHashParam("vtype"))&&"passwordlesslogin"!==i||h.passwordlessLoginFlag||(h.passwordlessLoginFlag=!0,T(n,e,o,t))}function t(){l(g,d,m,f)}function n(){var t,n,i,a,e;t=g,n=d,i=m,a=f,P(e=h.smartLoginSchema),y.createForm(e,"smartlogin",t,function(e){var o=w.checkPhoneOrEmailLogin(e);-1!==o.indexOf("phone")?v.loginOTPController(o,t,n,i,a):v.smartLoginController(o,n,i)},function(e){i(e)},a)}e.instantLinkLogin=o,e.passwordlessLoginValidate=o,e.autoLogin=n,e.smartLogin=n,e.noRegistrationPasswordLessLogin=t,e.onetouchLogin=t,e.default=function(){h.log("This action is not valid.")},(e[i]||e.default)()})}return this.trackEvent=function(){h.options.debugMode&&console.warn("Anonymous login feature has been deprecated")},w.unLinkAccount=function(e,o,t,n){var i,a;t=t||function(){},n=n||function(){},e&&o&&(i={provider:e,providerid:o},(a=h.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?w.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/socialIdentity?apiKey="+h.options.apiKey+"&access_token="+a,i,function(e){e.ErrorCode?n(y.loginRadiusErrorTojsError(e)):t(e,i)},"unLinkAccount"):n([y.setMappedMessage(C.tokenValid)]))},LoginRadiusHooksModel(h),setLoginRadiusModuleFunctions(h,t),h.init=function(e,o){h.useraction=e,t.maskSensitiveInput?h.otpSchema=[{type:"password",name:"otp",display:"OTP",rules:"required",permission:"r"}]:h.otpSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"}],"required"===t.twoFactorAuthentication?(t.twoFactorAuthentication=!0,t.optionalTwoFactorAuthentication=!1):"optional"===t.twoFactorAuthentication&&(t.twoFactorAuthentication=!1,t.optionalTwoFactorAuthentication=!0),"ssoLogin"!==e&&"logout"!==e&&"ssoNotLoginThenLogout"!==e||LoginRadiusDefaults.isSSOInitFired||(LoginRadiusDefaults.isSSOInitFired=!0,h.SSOinitFired=!0),t.appName||h.log("SSO will not work, please set option.appName for SSO"),t.formRenderDelay=t.formRenderDelay||0,t.apiKey?0<t.formRenderDelay?setTimeout(function(){n(e,o)},t.formRenderDelay):n(e,o):h.log("API key must be set.")},setLoginRadiusDefaultSchema(h),h.api=new LoginRadiusApiFramework(h,v),h};